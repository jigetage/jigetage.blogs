
                                            <p>&#x539F;&#x6587;&#x5730;&#x5740;&#xFF1A;<a href="https://blog.csdn.net/icandoit_2014/article/details/56666277" rel="nofollow" data-token="85a7e185784df0584fe8051f8fe6566d">&#x70B9;&#x51FB;&#x6253;&#x5F00;&#x94FE;&#x63A5;</a></p><p></p><h2 id="-" style="font-size:1.75em;color:rgb(51,51,51);line-height:1.225;font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);border-bottom:1px solid rgb(238,238,238);">&#x4E00;&#x3001;&#x672C;&#x8282;&#x5185;&#x5BB9;</h2><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">&#x672C;&#x8282;&#x5185;&#x5BB9;&#x5305;&#x62EC;&#xFF1A;</p><ul style="list-style:none;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><li style="font-size:15px;">&#x5BF9;&#x6807;&#x51C6;&#x5E93;&#x7684;&#x6269;&#x5145;: &#x667A;&#x80FD;&#x6307;&#x9488;&#x548C;&#x5F15;&#x7528;&#x8BA1;&#x6570;<ul style="list-style:none;"><li>RAII &#x4E0E;&#x5F15;&#x7528;&#x8BA1;&#x6570;</li><li><code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::shared_ptr</code></li><li><code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::unique_ptr</code></li><li><code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::weak_ptr</code></li></ul></li></ul><h2 id="-raii-" style="font-size:1.75em;color:rgb(51,51,51);line-height:1.225;font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);border-bottom:1px solid rgb(238,238,238);"><a name="t1"></a>&#x4E8C;&#x3001;RAII &#x4E0E;&#x5F15;&#x7528;&#x8BA1;&#x6570;</h2><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">&#x4E86;&#x89E3;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">Objective-C</code>/<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">Swift</code>&#xA0;&#x7684;&#x7A0B;&#x5E8F;&#x5458;&#x5E94;&#x8BE5;&#x77E5;&#x9053;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x7684;&#x6982;&#x5FF5;&#x3002;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x8FD9;&#x79CD;&#x8BA1;&#x6570;&#x662F;&#x4E3A;&#x4E86;&#x9632;&#x6B62;&#x5185;&#x5B58;&#x6CC4;&#x9732;&#x800C;&#x4EA7;&#x751F;&#x7684;&#x3002;&#x57FA;&#x672C;&#x60F3;&#x6CD5;&#x662F;&#x5BF9;&#x4E8E;&#x52A8;&#x6001;&#x5206;&#x914D;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x8FDB;&#x884C;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#xFF0C;&#x6BCF;&#x5F53;&#x589E;&#x52A0;&#x4E00;&#x6B21;&#x5BF9;&#x540C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#xFF0C;&#x90A3;&#x4E48;&#x5F15;&#x7528;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x5C31;&#x4F1A;&#x589E;&#x52A0;&#x4E00;&#x6B21;&#xFF0C;&#x6BCF;&#x5220;&#x9664;&#x4E00;&#x6B21;&#x5F15;&#x7528;&#xFF0C;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x5C31;&#x4F1A;&#x51CF;&#x4E00;&#xFF0C;&#x5F53;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x51CF;&#x4E3A;&#x96F6;&#x65F6;&#xFF0C;&#x5C31;&#x81EA;&#x52A8;&#x5220;&#x9664;&#x6307;&#x5411;&#x7684;&#x5806;&#x5185;&#x5B58;&#x3002;</p><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">&#x5728;&#x4F20;&#x7EDF; C++ &#x4E2D;&#xFF0C;&#x300E;&#x8BB0;&#x5F97;&#x300F;&#x624B;&#x52A8;&#x91CA;&#x653E;&#x8D44;&#x6E90;&#xFF0C;&#x603B;&#x4E0D;&#x662F;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#x3002;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x5F88;&#x6709;&#x53EF;&#x80FD;&#x5C31;&#x5FD8;&#x8BB0;&#x4E86;&#x53BB;&#x91CA;&#x653E;&#x8D44;&#x6E90;&#x800C;&#x5BFC;&#x81F4;&#x6CC4;&#x9732;&#x3002;&#x6240;&#x4EE5;&#x901A;&#x5E38;&#x7684;&#x505A;&#x6CD5;&#x662F;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x800C;&#x8A00;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x6784;&#x9020;&#x51FD;&#x6570;&#x7684;&#x65F6;&#x5019;&#x7533;&#x8BF7;&#x7A7A;&#x95F4;&#xFF0C;&#x800C;&#x5728;&#x6790;&#x6784;&#x51FD;&#x6570;&#xFF08;&#x5728;&#x79BB;&#x5F00;&#x4F5C;&#x7528;&#x57DF;&#x65F6;&#x8C03;&#x7528;&#xFF09;&#x7684;&#x65F6;&#x5019;&#x91CA;&#x653E;&#x7A7A;&#x95F4;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x5E38;&#x8BF4;&#x7684; RAII &#x8D44;&#x6E90;&#x83B7;&#x53D6;&#x5373;&#x521D;&#x59CB;&#x5316;&#x6280;&#x672F;&#x3002;</p><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">&#x51E1;&#x4E8B;&#x90FD;&#x6709;&#x4F8B;&#x5916;&#xFF0C;&#x6211;&#x4EEC;&#x603B;&#x4F1A;&#x6709;&#x9700;&#x8981;&#x5C06;&#x5BF9;&#x8C61;&#x5728;&#x81EA;&#x7531;&#x5B58;&#x50A8;&#x4E0A;&#x5206;&#x914D;&#x7684;&#x9700;&#x6C42;&#xFF0C;&#x5728;&#x4F20;&#x7EDF; C++ &#x91CC;&#x6211;&#x4EEC;&#x53EA;&#x597D;&#x4F7F;&#x7528;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">new</code>&#xA0;&#x548C;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">delete</code>&#xA0;&#x53BB;&#x300E;&#x8BB0;&#x5F97;&#x300F;&#x5BF9;&#x8D44;&#x6E90;&#x8FDB;&#x884C;&#x91CA;&#x653E;&#x3002;&#x800C; C++11 &#x5F15;&#x5165;&#x4E86;&#x667A;&#x80FD;&#x6307;&#x9488;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x4F7F;&#x7528;&#x4E86;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x7684;&#x60F3;&#x6CD5;&#xFF0C;&#x8BA9;&#x7A0B;&#x5E8F;&#x5458;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x5173;&#x5FC3;&#x624B;&#x52A8;&#x91CA;&#x653E;&#x5185;&#x5B58;&#x3002;&#x8FD9;&#x4E9B;&#x667A;&#x80FD;&#x6307;&#x9488;&#x5C31;&#x5305;&#x62EC;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::shared_ptr</code>/<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::unique_ptr</code>/<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::weak_ptr</code>&#xFF0C;&#x4F7F;&#x7528;&#x5B83;&#x4EEC;&#x9700;&#x8981;&#x5305;&#x542B;&#x5934;&#x6587;&#x4EF6;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">&lt;memory&gt;</code>&#x3002;</p><blockquote style="border-left:4px solid rgb(221,221,221);background:rgb(238,240,244);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;font-size:15px;color:rgb(119,119,119);"><p style="line-height:1.6em;">&#x6CE8;&#x610F;&#xFF1A;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x4E0D;&#x662F;&#x5783;&#x573E;&#x56DE;&#x6536;&#xFF0C;&#x5F15;&#x7528;&#x6280;&#x672F;&#x80FD;&#x591F;&#x5C3D;&#x5FEB;&#x6536;&#x56DE;&#x4E0D;&#x518D;&#x88AB;&#x4F7F;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x540C;&#x65F6;&#x5728;&#x56DE;&#x6536;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E5F;&#x4E0D;&#x4F1A;&#x9020;&#x6210;&#x957F;&#x65F6;&#x95F4;&#x7684;&#x7B49;&#x5F85;&#xFF0C;&#x66F4;&#x80FD;&#x591F;&#x6E05;&#x6670;&#x660E;&#x786E;&#x7684;&#x8868;&#x660E;&#x8D44;&#x6E90;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x3002;</p></blockquote><h2 id="-std-shared_ptr" style="font-size:1.75em;color:rgb(51,51,51);line-height:1.225;font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);border-bottom:1px solid rgb(238,238,238);"><a name="t2"></a>&#x4E09;&#x3001;std::shared_ptr</h2><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::shared_ptr</code>&#xA0;&#x662F;&#x4E00;&#x79CD;&#x667A;&#x80FD;&#x6307;&#x9488;&#xFF0C;&#x5B83;&#x80FD;&#x591F;&#x8BB0;&#x5F55;&#x591A;&#x5C11;&#x4E2A;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">shared_ptr</code>&#xA0;&#x5171;&#x540C;&#x6307;&#x5411;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x4ECE;&#x800C;&#x6D88;&#x9664;&#x663E;&#x793A;&#x7684;&#x8C03;&#x7528;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">delete</code>&#xFF0C;&#x5F53;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x53D8;&#x4E3A;&#x96F6;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x4F1A;&#x5C06;&#x5BF9;&#x8C61;&#x81EA;&#x52A8;&#x5220;&#x9664;&#x3002;</p><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">&#x4F46;&#x8FD8;&#x4E0D;&#x591F;&#xFF0C;&#x56E0;&#x4E3A;&#x4F7F;&#x7528;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::shared_ptr</code>&#xA0;&#x4ECD;&#x7136;&#x9700;&#x8981;&#x4F7F;&#x7528;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">new</code>&#xA0;&#x6765;&#x8C03;&#x7528;&#xFF0C;&#x8FD9;&#x4F7F;&#x5F97;&#x4EE3;&#x7801;&#x51FA;&#x73B0;&#x4E86;&#x67D0;&#x79CD;&#x7A0B;&#x5EA6;&#x4E0A;&#x7684;&#x4E0D;&#x5BF9;&#x79F0;&#x3002;</p><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::make_shared</code>&#xA0;&#x5C31;&#x80FD;&#x591F;&#x7528;&#x6765;&#x6D88;&#x9664;&#x663E;&#x793A;&#x7684;&#x4F7F;&#x7528;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">new</code>&#xFF0C;&#x6240;&#x4EE5;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::make_shared</code>&#xA0;&#x4F1A;&#x5206;&#x914D;&#x521B;&#x5EFA;&#x4F20;&#x5165;&#x53C2;&#x6570;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x7C7B;&#x578B;&#x7684;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::shared_ptr</code>&#x6307;&#x9488;&#x3002;&#x4F8B;&#x5982;&#xFF1A;</p><pre style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13px;line-height:1.42857;color:rgb(51,51,51);background-color:rgb(245,245,245);border:1px solid rgb(204,204,204);"><code class="lang-cpp hljs" style="color:rgb(248,248,242);background-color:rgb(35,36,31);font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;"></code></pre><ol class="hljs-ln" style="list-style:none;border-collapse:collapse;"><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-meta" style="color:rgb(117,113,94);font-size:15px;"><span class="hljs-meta" style="color:rgb(97,174,238);">#</span><span class="hljs-meta-keyword"><span class="hljs-meta" style="color:rgb(97,174,238);"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta" style="color:rgb(97,174,238);"> </span><span class="hljs-meta-string" style="color:rgb(152,195,121);"><span class="hljs-meta" style="color:rgb(97,174,238);"><span class="hljs-meta-string" style="color:rgb(152,195,121);">&lt;iostream&gt;</span></span></span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-meta" style="color:rgb(117,113,94);font-size:15px;"><span class="hljs-meta" style="color:rgb(97,174,238);">#</span><span class="hljs-meta-keyword"><span class="hljs-meta" style="color:rgb(97,174,238);"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta" style="color:rgb(97,174,238);"> </span><span class="hljs-meta-string" style="color:rgb(152,195,121);"><span class="hljs-meta" style="color:rgb(97,174,238);"><span class="hljs-meta-string" style="color:rgb(152,195,121);">&lt;memory&gt;</span></span></span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-function" style="font-size:15px;"><span class="hljs-keyword" style="color:rgb(249,38,114);"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(198,120,221);">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title" style="color:rgb(166,226,46);"><span class="hljs-function"><span class="hljs-title" style="color:rgb(97,174,238);">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in" style="color:rgb(230,219,116);"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in" style="color:rgb(230,219,116);"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in" style="color:rgb(230,192,123);">shared_ptr</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-keyword" style="color:rgb(249,38,114);"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword" style="color:rgb(198,120,221);">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; i)</span></span></span><span class="hljs-function"></span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">{</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    (*i)++;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">}</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-function" style="font-size:15px;"><span class="hljs-keyword" style="color:rgb(249,38,114);"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(198,120,221);">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title" style="color:rgb(166,226,46);"><span class="hljs-function"><span class="hljs-title" style="color:rgb(97,174,238);">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"></span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">{</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// auto pointer = new int(10); // &#x975E;&#x6CD5;, &#x4E0D;&#x5141;&#x8BB8;&#x76F4;&#x63A5;&#x8D4B;&#x503C;</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// &#x6784;&#x9020;&#x4E86;&#x4E00;&#x4E2A; std::shared_ptr</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">auto</span></span> pointer = <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::make_shared&lt;<span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">int</span></span>&gt;(<span class="hljs-number" style="color:rgb(174,129,255);font-size:15px;"><span class="hljs-number" style="color:rgb(209,154,102);">10</span></span>);</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    foo(pointer);</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; *pointer &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>; <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// 11</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// &#x79BB;&#x5F00;&#x4F5C;&#x7528;&#x57DF;&#x524D;&#xFF0C;shared_ptr &#x4F1A;&#x88AB;&#x6790;&#x6784;&#xFF0C;&#x4ECE;&#x800C;&#x91CA;&#x653E;&#x5185;&#x5B58;</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">return</span></span> <span class="hljs-number" style="color:rgb(174,129,255);font-size:15px;"><span class="hljs-number" style="color:rgb(209,154,102);">0</span></span>;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">}</div></div></li></ol><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::shared_ptr</code>&#xA0;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">get()</code>&#xA0;&#x65B9;&#x6CD5;&#x6765;&#x83B7;&#x53D6;&#x539F;&#x59CB;&#x6307;&#x9488;&#xFF0C;&#x901A;&#x8FC7;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">reset()</code>&#xA0;&#x6765;&#x51CF;&#x5C11;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#xFF0C;&#x5E76;&#x901A;&#x8FC7;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">get_count()</code>&#x6765;&#x67E5;&#x770B;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x3002;&#x4F8B;&#x5982;&#xFF1A;</p><pre style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13px;line-height:1.42857;color:rgb(51,51,51);background-color:rgb(245,245,245);border:1px solid rgb(204,204,204);"><code class="lang-cpp hljs" style="color:rgb(248,248,242);background-color:rgb(35,36,31);font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;"></code></pre><ol class="hljs-ln" style="list-style:none;border-collapse:collapse;"><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">auto</span></span> pointer = <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::make_shared&lt;<span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">int</span></span>&gt;(<span class="hljs-number" style="color:rgb(174,129,255);font-size:15px;"><span class="hljs-number" style="color:rgb(209,154,102);">10</span></span>);</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">auto</span></span> pointer2 = pointer;    <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// &#x5F15;&#x7528;&#x8BA1;&#x6570;+1</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">auto</span></span> pointer3 = pointer;    <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// &#x5F15;&#x7528;&#x8BA1;&#x6570;+1</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">int</span></span> *p = pointer.get();             <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// &#x8FD9;&#x6837;&#x4E0D;&#x4F1A;&#x589E;&#x52A0;&#x5F15;&#x7528;&#x8BA1;&#x6570;</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;pointer.use_count() = &quot;</span></span> &lt;&lt; pointer.use_count() &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;      <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// 3</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;pointer2.use_count() = &quot;</span></span> &lt;&lt; pointer2.use_count() &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;    <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// 3</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;pointer3.use_count() = &quot;</span></span> &lt;&lt; pointer3.use_count() &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;    <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// 3</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">pointer2.reset();</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;reset pointer2:&quot;</span></span> &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;pointer.use_count() = &quot;</span></span> &lt;&lt; pointer.use_count() &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;      <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// 2</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;pointer2.use_count() = &quot;</span></span> &lt;&lt; pointer2.use_count() &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;    <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// 0, pointer2 &#x5DF2; reset</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;pointer3.use_count() = &quot;</span></span> &lt;&lt; pointer3.use_count() &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;    <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// 2</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">pointer3.reset();</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;reset pointer3:&quot;</span></span> &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;pointer.use_count() = &quot;</span></span> &lt;&lt; pointer.use_count() &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;      <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// 1</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;pointer2.use_count() = &quot;</span></span> &lt;&lt; pointer2.use_count() &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;    <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// 0</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;pointer3.use_count() = &quot;</span></span> &lt;&lt; pointer3.use_count() &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;    <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// 0, pointer3 &#x5DF2; reset</span></span></div></div></li></ol><h2 id="-std-unique_ptr" style="font-size:1.75em;color:rgb(51,51,51);line-height:1.225;font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);border-bottom:1px solid rgb(238,238,238);"><a name="t3"></a>&#x56DB;&#x3001;std::unique_ptr</h2><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::unique_ptr</code>&#xA0;&#x662F;&#x4E00;&#x79CD;&#x72EC;&#x5360;&#x7684;&#x667A;&#x80FD;&#x6307;&#x9488;&#xFF0C;&#x5B83;&#x7981;&#x6B62;&#x5176;&#x4ED6;&#x667A;&#x80FD;&#x6307;&#x9488;&#x4E0E;&#x5176;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x4ECE;&#x800C;&#x4FDD;&#x8BC1;&#x4E86;&#x4EE3;&#x7801;&#x7684;&#x5B89;&#x5168;&#xFF1A;</p><pre style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13px;line-height:1.42857;color:rgb(51,51,51);background-color:rgb(245,245,245);border:1px solid rgb(204,204,204);"><code class="lang-cpp hljs" style="color:rgb(248,248,242);background-color:rgb(35,36,31);font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;"></code></pre><ol class="hljs-ln" style="list-style:none;border-collapse:collapse;"><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">unique_ptr</span></span>&lt;<span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">int</span></span>&gt; pointer = <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::make_unique&lt;<span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">int</span></span>&gt;(<span class="hljs-number" style="color:rgb(174,129,255);font-size:15px;"><span class="hljs-number" style="color:rgb(209,154,102);">10</span></span>);   <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// make_unique &#x4ECE; C++14 &#x5F15;&#x5165;</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">unique_ptr</span></span>&lt;<span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">int</span></span>&gt; pointer2 = pointer;    <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// &#x975E;&#x6CD5;</span></span></div></div></li></ol><blockquote style="border-left:4px solid rgb(221,221,221);background:rgb(238,240,244);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;font-size:15px;color:rgb(119,119,119);"><p style="line-height:1.6em;">make_unique &#x5E76;&#x4E0D;&#x590D;&#x6742;&#xFF0C;C++11 &#x6CA1;&#x6709;&#x63D0;&#x4F9B; std::make_unique&#xFF0C;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x5B9E;&#x73B0;&#xFF1A;</p><pre style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13px;line-height:1.42857;color:rgb(51,51,51);background-color:rgb(245,245,245);border:1px solid rgb(204,204,204);"><code class="lang-cpp hljs" style="color:rgb(248,248,242);background-color:rgb(35,36,31);font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;"></code></pre><ol class="hljs-ln" style="list-style:none;border-collapse:collapse;"><li style="margin-left:0px;list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">template</span></span>&lt;<span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">typename</span></span> T, <span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">typename</span></span> ...Args&gt;</div></div></li><li style="margin-left:0px;list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">unique_ptr</span></span>&lt;T&gt; make_unique( Args&amp;&amp; ...args ) {</div></div></li><li style="margin-left:0px;list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">return</span></span> <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">unique_ptr</span></span>&lt;T&gt;( <span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">new</span></span> T( <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::forward&lt;Args&gt;(args)... ) );</div></div></li><li style="margin-left:0px;list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">}</div></div></li></ol><p style="line-height:1.6em;">&#x81F3;&#x4E8E;&#x4E3A;&#x4EC0;&#x4E48;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#xFF0C;C++ &#x6807;&#x51C6;&#x59D4;&#x5458;&#x4F1A;&#x4E3B;&#x5E2D; Herb Sutter &#x5728;&#x4ED6;&#x7684;<a href="https://herbsutter.com/gotw/_102/" rel="nofollow" style="color:rgb(64,120,192);background-color:transparent;" data-token="8281cb291b72785c0c28ae6b405d6559">&#x535A;&#x5BA2;</a>&#x4E2D;&#x63D0;&#x5230;&#x539F;&#x56E0;&#x662F;&#x56E0;&#x4E3A;&#x300E;&#x88AB;&#x4ED6;&#x4EEC;&#x5FD8;&#x8BB0;&#x4E86;&#x300F;&#x3002;</p></blockquote><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">&#x65E2;&#x7136;&#x662F;&#x72EC;&#x5360;&#xFF0C;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#x5C31;&#x662F;&#x4E0D;&#x53EF;&#x590D;&#x5236;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::move</code>&#xA0;&#x5C06;&#x5176;&#x8F6C;&#x79FB;&#x7ED9;&#x5176;&#x4ED6;&#x7684;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">unique_ptr</code>&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;</p><pre style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13px;line-height:1.42857;color:rgb(51,51,51);background-color:rgb(245,245,245);border:1px solid rgb(204,204,204);"><code class="lang-cpp hljs" style="color:rgb(248,248,242);background-color:rgb(35,36,31);font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;"></code></pre><ol class="hljs-ln" style="list-style:none;border-collapse:collapse;"><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-meta" style="color:rgb(117,113,94);font-size:15px;"><span class="hljs-meta" style="color:rgb(97,174,238);">#</span><span class="hljs-meta-keyword"><span class="hljs-meta" style="color:rgb(97,174,238);"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta" style="color:rgb(97,174,238);"> </span><span class="hljs-meta-string" style="color:rgb(152,195,121);"><span class="hljs-meta" style="color:rgb(97,174,238);"><span class="hljs-meta-string" style="color:rgb(152,195,121);">&lt;iostream&gt;</span></span></span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-meta" style="color:rgb(117,113,94);font-size:15px;"><span class="hljs-meta" style="color:rgb(97,174,238);">#</span><span class="hljs-meta-keyword"><span class="hljs-meta" style="color:rgb(97,174,238);"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta" style="color:rgb(97,174,238);"> </span><span class="hljs-meta-string" style="color:rgb(152,195,121);"><span class="hljs-meta" style="color:rgb(97,174,238);"><span class="hljs-meta-string" style="color:rgb(152,195,121);">&lt;memory&gt;</span></span></span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-class"><span class="hljs-keyword" style="color:rgb(198,120,221);">struct</span></span></span><span class="hljs-class"> <span class="hljs-title" style="color:rgb(230,192,123);">Foo</span> {</span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    Foo()      { <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;Foo::Foo&quot;</span></span> &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;  }</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    ~Foo()     { <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;Foo::~Foo&quot;</span></span> &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>; }</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-function" style="font-size:15px;"><span class="hljs-keyword" style="color:rgb(249,38,114);"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(198,120,221);">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title" style="color:rgb(166,226,46);"><span class="hljs-function"><span class="hljs-title" style="color:rgb(97,174,238);">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;Foo::foo&quot;</span></span> &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;  }</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">};</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-function" style="font-size:15px;"><span class="hljs-keyword" style="color:rgb(249,38,114);"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(198,120,221);">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title" style="color:rgb(166,226,46);"><span class="hljs-function"><span class="hljs-title" style="color:rgb(97,174,238);">f</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword" style="color:rgb(249,38,114);"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword" style="color:rgb(198,120,221);">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Foo &amp;)</span></span></span><span class="hljs-function"> </span></span>{</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;f(const Foo&amp;)&quot;</span></span> &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">}</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-function" style="font-size:15px;"><span class="hljs-keyword" style="color:rgb(249,38,114);"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(198,120,221);">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title" style="color:rgb(166,226,46);"><span class="hljs-function"><span class="hljs-title" style="color:rgb(97,174,238);">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">unique_ptr</span></span>&lt;Foo&gt; p1(<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::make_unique&lt;Foo&gt;());</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// p1 &#x4E0D;&#x7A7A;, &#x8F93;&#x51FA;</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">if</span></span> (p1) p1-&gt;foo();</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    {</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">unique_ptr</span></span>&lt;Foo&gt; p2(<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::move(p1));</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// p2 &#x4E0D;&#x7A7A;, &#x8F93;&#x51FA;</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        f(*p2);</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// p2 &#x4E0D;&#x7A7A;, &#x8F93;&#x51FA;</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">if</span></span>(p2) p2-&gt;foo();</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// p1 &#x4E3A;&#x7A7A;, &#x65E0;&#x8F93;&#x51FA;</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">if</span></span>(p1) p1-&gt;foo();</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        p1 = <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::move(p2);</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// p2 &#x4E3A;&#x7A7A;, &#x65E0;&#x8F93;&#x51FA;</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">if</span></span>(p2) p2-&gt;foo();</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;p2 &#x88AB;&#x9500;&#x6BC1;&quot;</span></span> &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    }</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// p1 &#x4E0D;&#x7A7A;, &#x8F93;&#x51FA;</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">if</span></span> (p1) p1-&gt;foo();</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// Foo &#x7684;&#x5B9E;&#x4F8B;&#x4F1A;&#x5728;&#x79BB;&#x5F00;&#x4F5C;&#x7528;&#x57DF;&#x65F6;&#x88AB;&#x9500;&#x6BC1;</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">}</div></div></li></ol><h2 id="-std-weak_ptr" style="font-size:1.75em;color:rgb(51,51,51);line-height:1.225;font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);border-bottom:1px solid rgb(238,238,238);"><a name="t4"></a>&#x4E94;&#x3001;std::weak_ptr</h2><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">&#x5982;&#x679C;&#x4F60;&#x4ED4;&#x7EC6;&#x601D;&#x8003;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::shared_ptr</code>&#xA0;&#x5C31;&#x4F1A;&#x53D1;&#x73B0;&#x4F9D;&#x7136;&#x5B58;&#x5728;&#x7740;&#x8D44;&#x6E90;&#x65E0;&#x6CD5;&#x91CA;&#x653E;&#x7684;&#x95EE;&#x9898;&#x3002;&#x770B;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#xFF1A;</p><pre style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13px;line-height:1.42857;color:rgb(51,51,51);background-color:rgb(245,245,245);border:1px solid rgb(204,204,204);"><code class="lang-cpp hljs" style="color:rgb(248,248,242);background-color:rgb(35,36,31);font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;"></code></pre><ol class="hljs-ln" style="list-style:none;border-collapse:collapse;"><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-meta" style="color:rgb(117,113,94);font-size:15px;"><span class="hljs-meta" style="color:rgb(97,174,238);">#</span><span class="hljs-meta-keyword"><span class="hljs-meta" style="color:rgb(97,174,238);"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta" style="color:rgb(97,174,238);"> </span><span class="hljs-meta-string" style="color:rgb(152,195,121);"><span class="hljs-meta" style="color:rgb(97,174,238);"><span class="hljs-meta-string" style="color:rgb(152,195,121);">&lt;iostream&gt;</span></span></span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-meta" style="color:rgb(117,113,94);font-size:15px;"><span class="hljs-meta" style="color:rgb(97,174,238);">#</span><span class="hljs-meta-keyword"><span class="hljs-meta" style="color:rgb(97,174,238);"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta" style="color:rgb(97,174,238);"> </span><span class="hljs-meta-string" style="color:rgb(152,195,121);"><span class="hljs-meta" style="color:rgb(97,174,238);"><span class="hljs-meta-string" style="color:rgb(152,195,121);">&lt;memory&gt;</span></span></span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-class"><span class="hljs-keyword" style="color:rgb(198,120,221);">class</span></span></span><span class="hljs-class"> <span class="hljs-title" style="color:rgb(230,192,123);">A</span>;</span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-class"><span class="hljs-keyword" style="color:rgb(198,120,221);">class</span></span></span><span class="hljs-class"> <span class="hljs-title" style="color:rgb(230,192,123);">B</span>;</span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-class"><span class="hljs-keyword" style="color:rgb(198,120,221);">class</span></span></span><span class="hljs-class"> <span class="hljs-title" style="color:rgb(230,192,123);">A</span> {</span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">public</span></span>:</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">shared_ptr</span></span>&lt;B&gt; pointer;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    ~A() {</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;A &#x88AB;&#x9500;&#x6BC1;&quot;</span></span> &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    }</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">};</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-class"><span class="hljs-keyword" style="color:rgb(198,120,221);">class</span></span></span><span class="hljs-class"> <span class="hljs-title" style="color:rgb(230,192,123);">B</span> {</span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">public</span></span>:</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">shared_ptr</span></span>&lt;A&gt; pointer;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    ~B() {</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;B &#x88AB;&#x9500;&#x6BC1;&quot;</span></span> &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    }</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">};</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-function" style="font-size:15px;"><span class="hljs-keyword" style="color:rgb(249,38,114);"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(198,120,221);">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title" style="color:rgb(166,226,46);"><span class="hljs-function"><span class="hljs-title" style="color:rgb(97,174,238);">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">shared_ptr</span></span>&lt;A&gt; a = <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::make_shared&lt;A&gt;();</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">shared_ptr</span></span>&lt;B&gt; b = <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::make_shared&lt;B&gt;();</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    a-&gt;pointer = b;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    b-&gt;pointer = a;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">return</span></span> <span class="hljs-number" style="color:rgb(174,129,255);font-size:15px;"><span class="hljs-number" style="color:rgb(209,154,102);">0</span></span>;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">}</div></div></li></ol><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#x662F; A, B &#x90FD;&#x4E0D;&#x4F1A;&#x88AB;&#x9500;&#x6BC1;&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A; a,b &#x5185;&#x90E8;&#x7684; pointer &#x540C;&#x65F6;&#x53C8;&#x5F15;&#x7528;&#x4E86;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">a,b</code>&#xFF0C;&#x8FD9;&#x4F7F;&#x5F97;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">a,b</code>&#xA0;&#x7684;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x5747;&#x53D8;&#x4E3A;&#x4E86; 2&#xFF0C;&#x800C;&#x79BB;&#x5F00;&#x4F5C;&#x7528;&#x57DF;&#x65F6;&#xFF0C;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">a,b</code>&#xA0;&#x667A;&#x80FD;&#x6307;&#x9488;&#x88AB;&#x6790;&#x6784;&#xFF0C;&#x5374;&#x667A;&#x80FD;&#x9020;&#x6210;&#x8FD9;&#x5757;&#x533A;&#x57DF;&#x7684;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x51CF;&#x4E00;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x5BFC;&#x81F4;&#x4E86;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">a,b</code>&#xA0;&#x5BF9;&#x8C61;&#x6307;&#x5411;&#x7684;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x4E0D;&#x4E3A;&#x96F6;&#xFF0C;&#x800C;&#x5916;&#x90E8;&#x5DF2;&#x7ECF;&#x6CA1;&#x6709;&#x529E;&#x6CD5;&#x627E;&#x5230;&#x8FD9;&#x5757;&#x533A;&#x57DF;&#x4E86;&#xFF0C;&#x4E5F;&#x5C31;&#x9020;&#x6210;&#x4E86;&#x5185;&#x5B58;&#x6CC4;&#x9732;&#xFF0C;&#x5982;&#x56FE;&#x6240;&#x793A;&#xFF1A;</p><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><img src="https://dn-anything-about-doc.qbox.me/document-uid29879labid2026timestamp1471596481875.png/wm" alt="&#x6B64;&#x5904;&#x8F93;&#x5165;&#x56FE;&#x7247;&#x7684;&#x63CF;&#x8FF0;" style="border:0px none;vertical-align:middle;"></p><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x529E;&#x6CD5;&#x5C31;&#x662F;&#x4F7F;&#x7528;&#x5F31;&#x5F15;&#x7528;&#x6307;&#x9488;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::weak_ptr</code>&#xFF0C;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::weak_ptr</code>&#x662F;&#x4E00;&#x79CD;&#x5F31;&#x5F15;&#x7528;&#xFF08;&#x76F8;&#x6BD4;&#x8F83;&#x800C;&#x8A00;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::shared_ptr</code>&#xA0;&#x5C31;&#x662F;&#x4E00;&#x79CD;&#x5F3A;&#x5F15;&#x7528;&#xFF09;&#x3002;&#x5F31;&#x5F15;&#x7528;&#x4E0D;&#x4F1A;&#x5F15;&#x8D77;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x589E;&#x52A0;&#xFF0C;&#x5F53;&#x6362;&#x7528;&#x5F31;&#x5F15;&#x7528;&#x65F6;&#x5019;&#xFF0C;&#x6700;&#x7EC8;&#x7684;&#x91CA;&#x653E;&#x6D41;&#x7A0B;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF1A;</p><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><img src="https://dn-anything-about-doc.qbox.me/document-uid29879labid2026timestamp1471596487030.png/wm" alt="&#x6B64;&#x5904;&#x8F93;&#x5165;&#x56FE;&#x7247;&#x7684;&#x63CF;&#x8FF0;" style="border:0px none;vertical-align:middle;"></p><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">&#x5728;&#x4E0A;&#x56FE;&#x4E2D;&#xFF0C;&#x6700;&#x540E;&#x4E00;&#x6B65;&#x53EA;&#x5269;&#x4E0B; B&#xFF0C;&#x800C; B &#x5E76;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x667A;&#x80FD;&#x6307;&#x9488;&#x5F15;&#x7528;&#x5B83;&#xFF0C;&#x56E0;&#x6B64;&#x8FD9;&#x5757;&#x5185;&#x5B58;&#x8D44;&#x6E90;&#x4E5F;&#x4F1A;&#x88AB;&#x91CA;&#x653E;&#x3002;</p><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::weak_ptr</code>&#xA0;&#x6CA1;&#x6709;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">*</code>&#xA0;&#x8FD0;&#x7B97;&#x7B26;&#x548C;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">-&gt;</code>&#xA0;&#x8FD0;&#x7B97;&#x7B26;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x80FD;&#x591F;&#x5BF9;&#x8D44;&#x6E90;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#xFF0C;&#x5B83;&#x7684;&#x552F;&#x4E00;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x7528;&#x4E8E;&#x68C0;&#x67E5;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">std::shared_ptr</code>&#x662F;&#x5426;&#x5B58;&#x5728;&#xFF0C;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">expired()</code>&#xA0;&#x65B9;&#x6CD5;&#x5728;&#x8D44;&#x6E90;&#x672A;&#x88AB;&#x91CA;&#x653E;&#x65F6;&#xFF0C;&#x4F1A;&#x8FD4;&#x56DE;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">true</code>&#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">false</code>&#x3002;</p><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">&#x6B63;&#x786E;&#x7684;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p><pre style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13px;line-height:1.42857;color:rgb(51,51,51);background-color:rgb(245,245,245);border:1px solid rgb(204,204,204);"><code class="lang-cpp hljs" style="color:rgb(248,248,242);background-color:rgb(35,36,31);font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;"></code></pre><ol class="hljs-ln" style="list-style:none;border-collapse:collapse;"><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-meta" style="color:rgb(117,113,94);font-size:15px;"><span class="hljs-meta" style="color:rgb(97,174,238);">#</span><span class="hljs-meta-keyword"><span class="hljs-meta" style="color:rgb(97,174,238);"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta" style="color:rgb(97,174,238);"> </span><span class="hljs-meta-string" style="color:rgb(152,195,121);"><span class="hljs-meta" style="color:rgb(97,174,238);"><span class="hljs-meta-string" style="color:rgb(152,195,121);">&lt;iostream&gt;</span></span></span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-meta" style="color:rgb(117,113,94);font-size:15px;"><span class="hljs-meta" style="color:rgb(97,174,238);">#</span><span class="hljs-meta-keyword"><span class="hljs-meta" style="color:rgb(97,174,238);"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta" style="color:rgb(97,174,238);"> </span><span class="hljs-meta-string" style="color:rgb(152,195,121);"><span class="hljs-meta" style="color:rgb(97,174,238);"><span class="hljs-meta-string" style="color:rgb(152,195,121);">&lt;memory&gt;</span></span></span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-class"><span class="hljs-keyword" style="color:rgb(198,120,221);">class</span></span></span><span class="hljs-class"> <span class="hljs-title" style="color:rgb(230,192,123);">A</span>;</span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-class"><span class="hljs-keyword" style="color:rgb(198,120,221);">class</span></span></span><span class="hljs-class"> <span class="hljs-title" style="color:rgb(230,192,123);">B</span>;</span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-class"><span class="hljs-keyword" style="color:rgb(198,120,221);">class</span></span></span><span class="hljs-class"> <span class="hljs-title" style="color:rgb(230,192,123);">A</span> {</span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">public</span></span>:</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-comment" style="color:rgb(117,113,94);font-style:italic;font-size:15px;"><span class="hljs-comment" style="color:rgb(92,99,112);">// A &#x6216; B &#x4E2D;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x4F7F;&#x7528; weak_ptr</span></span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::weak_ptr&lt;B&gt; pointer;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    ~A() {</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;A &#x88AB;&#x9500;&#x6BC1;&quot;</span></span> &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    }</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">};</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-class"><span class="hljs-keyword" style="color:rgb(198,120,221);">class</span></span></span><span class="hljs-class"> <span class="hljs-title" style="color:rgb(230,192,123);">B</span> {</span></div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">public</span></span>:</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">shared_ptr</span></span>&lt;A&gt; pointer;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    ~B() {</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">cout</span></span> &lt;&lt; <span class="hljs-string" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-string" style="color:rgb(152,195,121);">&quot;B &#x88AB;&#x9500;&#x6BC1;&quot;</span></span> &lt;&lt; <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">endl</span></span>;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    }</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">};</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-function" style="font-size:15px;"><span class="hljs-keyword" style="color:rgb(249,38,114);"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(198,120,221);">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title" style="color:rgb(166,226,46);"><span class="hljs-function"><span class="hljs-title" style="color:rgb(97,174,238);">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">shared_ptr</span></span>&lt;A&gt; a = <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::make_shared&lt;A&gt;();</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::<span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">shared_ptr</span></span>&lt;B&gt; b = <span class="hljs-built_in" style="color:rgb(230,219,116);font-size:15px;"><span class="hljs-built_in" style="color:rgb(230,192,123);">std</span></span>::make_shared&lt;B&gt;();</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    a-&gt;pointer = b;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    b-&gt;pointer = a;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-keyword" style="color:rgb(249,38,114);font-size:15px;"><span class="hljs-keyword" style="color:rgb(198,120,221);">return</span></span> <span class="hljs-number" style="color:rgb(174,129,255);font-size:15px;"><span class="hljs-number" style="color:rgb(209,154,102);">0</span></span>;</div></div></li><li style="list-style-type:none;"><div class="hljs-ln-numbers" style="width:24px;border-right:1px solid rgb(197,197,197);"><div class="hljs-ln-line hljs-ln-n" style="text-align:right;"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">}</div></div></li></ol><h2 style="font-size:1.75em;color:rgb(51,51,51);line-height:1.225;font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);border-bottom:1px solid rgb(238,238,238);"><a name="t5"></a>&#x603B;&#x7ED3;</h2><p style="font-size:15px;color:rgb(51,51,51);font-family:&apos;-apple-system&apos;, &apos;SF UI Text&apos;, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">&#x667A;&#x80FD;&#x6307;&#x9488;&#x8FD9;&#x79CD;&#x6280;&#x672F;&#x5E76;&#x4E0D;&#x65B0;&#x5947;&#xFF0C;&#x5728;&#x5F88;&#x591A;&#x8BED;&#x8A00;&#x4E2D;&#x90FD;&#x662F;&#x4E00;&#x79CD;&#x5E38;&#x89C1;&#x7684;&#x6280;&#x672F;&#xFF0C;C++1x &#x5C06;&#x8FD9;&#x9879;&#x6280;&#x672F;&#x5F15;&#x8FDB;&#xFF0C;&#x5728;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x4E0A;&#x6D88;&#x9664;&#x4E86;&#xA0;<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">new</code>/<code style="font-family:Menlo, Monaco, Consolas, &apos;Courier New&apos;, monospace;font-size:13.5px;">delete</code>&#xA0;&#x7684;&#x6EE5;&#x7528;&#xFF0C;&#x662F;&#x4E00;&#x79CD;&#x66F4;&#x52A0;&#x6210;&#x719F;&#x7684;&#x7F16;&#x7A0B;&#x8303;&#x5F0F;&#x3002;</p><br>                                    