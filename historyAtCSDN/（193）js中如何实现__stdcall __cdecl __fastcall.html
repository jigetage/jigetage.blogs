
                                            <p style="background-color:rgb(255,255,255);">&#x539F;&#x6587;&#x94FE;&#x63A5;&#xFF1A;<a href="https://blog.csdn.net/wangjia184/article/details/18940165" rel="nofollow" data-token="60361d56ef5223087965fd228a24d54e">&#x70B9;&#x51FB;&#x6253;&#x5F00;&#x94FE;&#x63A5;</a></p><p style="background-color:rgb(255,255,255);">&#x5982;&#x679C;&#x8981;&#x5728;nodejs&#x4E2D;&#x8C03;&#x7528;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5E93;&#x4E2D;&#x7684;&#x5BFC;&#x51FA;&#x65B9;&#x6CD5;&#xFF0C;&#x6216;&#x8005;&#x4ECE;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5E93;&#x4E2D;&#x56DE;&#x8C03;nodejs&#x4E2D;&#x7684;&#x67D0;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x91C7;&#x7528; node-ffi&#xFF08;<a href="https://github.com/rbranson/node-ffi" rel="nofollow" data-token="f41241f8188a768405b0010ed86c34b8">https://github.com/rbranson/node-ffi</a>&#xA0;)&#x3002;&#x4E0D;&#x8FC7;&#x6211;&#x8BD5;&#x4E86;&#x5F88;&#x4E45;&#x90FD;&#x6CA1;&#x6709;&#x6210;&#x529F;&#xFF0C;&#x8C8C;&#x4F3C;ffi&#x5BF9;&#x4E8E;&#x56DE;&#x8C03;&#x7684;&#x652F;&#x6301;&#x6709;&#x95EE;&#x9898;&#xFF0C;&#x65E0;&#x6CD5;&#x6B63;&#x786E;&#x533A;&#x5206; _stdcall &#x4E0E; _cdecl&#x3002;&#x800C;&#x53E6;&#x4E00;&#x79CD;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#x5C31;&#x975E;&#x5E38;&#x7B80;&#x5355;&#x76F4;&#x63A5;&#x4E86;&#xFF0C;&#x901A;&#x8FC7;&#x7F16;&#x5199;nodejs addon&#x7684;&#x65B9;&#x5F0F;&#x76F4;&#x63A5;&#x5B9E;&#x73B0;&#x3002;</p><p style="background-color:rgb(255,255,255);"><br></p><p style="background-color:rgb(255,255,255);">nodejs&#x4E2D;&#x7684;addon&#x4F7F;&#x7528;C&#x7F16;&#x5199;&#xFF0C;&#x5176;&#x7F16;&#x8BD1;&#x94FE;&#x63A5;&#x7684;&#x5DE5;&#x5177;&#x94FE;&#x4E0D;&#x662F;&#x5E38;&#x89C1;&#x7684;makefile autoconf&#x4E4B;&#x7C7B;&#xFF0C;&#x800C;&#x662F;&#x4ECE;Chromium&#x79FB;&#x690D;&#x6765;&#x7684;node-gyp&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x5982;&#x679C;&#x76F4;&#x63A5;&#x5C06;&#x590D;&#x6742;&#x7684;C/C++&#x4EE3;&#x7801;&#x5728;addon&#x4E2D;&#x5B9E;&#x73B0;&#xFF0C;&#x5BB9;&#x6613;&#x4EA7;&#x751F;&#x7F16;&#x8BD1;&#x6216;&#x8005;&#x94FE;&#x63A5;&#x51B2;&#x7A81;&#x3002;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x5F0F;&#x662F;&#xFF0C;addon&#x53EA;&#x4F5C;&#x4E3A;adapter&#x4F7F;&#x7528;&#xFF0C;&#x5728;addon&#x4E2D;&#x901A;&#x8FC7;dlopen/LoadLibrary&#x53BB;&#x64CD;&#x7EB5;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5E93;&#x6216;&#x8005;&#x56DE;&#x8C03;js.</p><p style="background-color:rgb(255,255,255);"><br></p><p style="background-color:rgb(255,255,255);"><a href="http://nodejs.org/api/addons.html" rel="nofollow" data-token="97af40c5bae62905b6877e2af4393fd6">http://nodejs.org/api/addons.html</a>&#xA0;&#x6709;&#x5B9E;&#x73B0;Addon&#x7684;&#x57FA;&#x672C;&#x8BB2;&#x89E3;&#x3002;<br></p><p style="background-color:rgb(255,255,255);"><br></p><h1 style="padding:0px;background-color:rgb(255,255,255);"><a></a><span style="font-size:32px;">AddOn&#x7684;&#x57FA;&#x672C;&#x7ED3;&#x6784;</span></h1><p style="background-color:rgb(255,255,255);">&#x9996;&#x5148;&#x65B0;&#x5EFA;<a href="http://nodejs.org/api/addons.html" rel="nofollow" data-token="97af40c5bae62905b6877e2af4393fd6">a</a>dapter.cc, &#x8D34;&#x56FE;&#x5982;&#x4E0B;&#x4EE3;&#x7801;</p><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_cpp" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[cpp]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-cpp" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="preprocessor" style="margin:0px;padding:0px;border:none;color:#808080;background-color:inherit;">#include&#xA0;&lt;node.h&gt;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="preprocessor" style="margin:0px;padding:0px;border:none;color:#808080;background-color:inherit;">#include&#xA0;&lt;v8.h&gt;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">using</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">namespace</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;v8;&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;init(Handle&lt;Object&gt;&#xA0;exports)&#xA0;{&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">}&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">NODE_MODULE(mq,&#xA0;init)&#xA0;&#xA0;</span></li></ol></div><br style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x201C;&#x7A7A;&#x201D;&#x7684;addon&#xFF0C;&#x5565;&#x4E8B;&#x90FD;&#x6CA1;&#x5E72;&#x3002;</span><span style="font-weight:700;color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">NODE_MODULE</span><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x5B8F;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x8BE5;&#x6A21;&#x5757;&#x7684;&#x540D;&#x79F0;&#xFF1B;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x521D;&#x59CB;&#x5316;&#x51FD;&#x6570;init&#xFF0C;&#x6B64;&#x51FD;&#x6570;&#x5728;addon&#x52A0;&#x8F7D;&#x540E;&#x8C03;&#x7528;&#x3002;</span><p style="background-color:rgb(255,255,255);"></p><p style="background-color:rgb(255,255,255);">&#x7136;&#x540E;&#x5728;<span style="font-weight:700;">adapter.cc</span>&#x540C;&#x76EE;&#x5F55;&#x4E2D;&#x65B0;&#x5EFA;&#x6587;&#x4EF6;<span style="font-weight:700;">building.gyp</span>&#xFF0C;&#x5B83;&#x7684;&#x5185;&#x5BB9;&#x662F;JSON&#x683C;&#x5F0F;</p><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_javascript" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[javascript]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-c" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;background-color:inherit;">{&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;<span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&quot;targets&quot;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:&#xA0;[&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;{&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&quot;target_name&quot;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:&#xA0;</span><span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&quot;mq&quot;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&quot;sources&quot;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">:&#xA0;[&#xA0;</span><span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&quot;adapter.cc&quot;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;]&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;]&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">}&#xA0;&#xA0;</span></li></ol></div><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;</span><span style="font-weight:700;color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">target_name</span><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x5FC5;&#x987B;&#x548C;NODE_MODULE&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x76F8;&#x540C;&#x3002;</span><p style="background-color:rgb(255,255,255);"></p><p style="background-color:rgb(255,255,255);">&#x7136;&#x540E;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x6B64;&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x4F7F;&#x7528;gyp&#x7F16;&#x8BD1;&#x4E86;</p><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_plain" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[plain]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;background-color:inherit;">node-gyp&#xA0;configure&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">node-gyp&#xA0;rebuild&#xA0;&#xA0;</span></li></ol></div><br style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x7F16;&#x8BD1;&#x7684;&#x7ED3;&#x679C;&#x5728;build/release&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x6587;&#x4EF6;&#x7684;&#x6269;&#x5C55;&#x540D;&#x662F; *.node, &#x800C;&#x6587;&#x4EF6;&#x540D;&#x5C31;&#x662F;&#x4E4B;&#x524D;&#x6307;&#x5B9A;&#x7684;&#x6A21;&#x5757;&#x540D;&#x3002;</span><p style="background-color:rgb(255,255,255);"></p><p style="background-color:rgb(255,255,255);">&#x5C06;&#x6B64;*.node&#x6587;&#x4EF6;&#x62F7;&#x8D1D;&#x5230;nodejs&#x5DE5;&#x7A0B;&#x4E2D;&#x7684;<span style="font-weight:700;">node_modules</span>&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x52A0;&#x8F7D;&#x4E86;&#x3002;</p><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_javascript" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[javascript]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-c" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">var</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;MQ&#xA0;=&#xA0;require(</span><span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&apos;mq.node&apos;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">console.log(MQ);&#xA0;&#xA0;</span></li></ol></div><br style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"><br style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"><p style="background-color:rgb(255,255,255);"></p><h1 style="padding:0px;background-color:rgb(255,255,255);"><a></a><span style="font-size:32px;">Addon&#x4E2D;&#x6CE8;&#x518C;&#x65B9;&#x6CD5;&#x4F9B;NodeJS&#x8C03;&#x7528;</span></h1><p style="background-color:rgb(255,255,255);">&#x5728;Addon&#x4E2D;&#x88AB;NodeJS&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#x539F;&#x578B;&#x5FC5;&#x987B;&#x662F;&#xA0;<span style="font-weight:700;">Handle&lt;Value&gt; method(const Arguments&amp; args)</span>, &#x5728;&#x6A21;&#x5757;&#x521D;&#x59CB;&#x5316;&#x7684;&#x65F6;&#x5019;&#x6CE8;&#x518C;&#x6B64;&#x65B9;&#x6CD5;&#x3002;&#x5982;&#xFF1A;</p><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_cpp" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[cpp]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-cpp" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;background-color:inherit;">Handle&lt;Value&gt;&#xA0;XXXXXX(</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">const</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;Arguments&amp;&#xA0;args)&#xA0;{&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;HandleScope&#xA0;scope;&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;<span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">return</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;scope.Close(Undefined());&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">}&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;init(Handle&lt;Object&gt;&#xA0;exports)&#xA0;{&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;exports-&gt;Set(String::NewSymbol(<span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&quot;XXXXXX&quot;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">),&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;FunctionTemplate::New(XXXXXX&lt;span&#xA0;style=<span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&quot;font-family:Arial,&#xA0;Helvetica,&#xA0;sans-serif;&quot;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&gt;)-&gt;GetFunction());&lt;/span&gt;&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">}&#xA0;&#xA0;</span></li></ol></div><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x5728;nodejs&#x4E2D;&#x5373;&#x53EF;&#x8C03;&#x7528;&#x6B64;&#x65B9;&#x6CD5;</span><br style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"><div class="dp-highlighter bg_javascript" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[javascript]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-c" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">var</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;MQ&#xA0;=&#xA0;require(</span><span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&apos;mq.node&apos;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">MQ.XXXXXX(&#xA0;2,&#xA0;<span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">false</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&#xA0;</span><span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&apos;Text&apos;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&#xA0;&#xA0;</span></span></li></ol></div><br style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x4ECE;javascript&#x8FD9;&#x6837;&#x7684;&#x5F31;&#x7C7B;&#x578B;&#x8BED;&#x8A00;&#x5411;C&#x5F3A;&#x7C7B;&#x578B;&#x8BED;&#x8A00;&#x4F20;&#x9012;&#x53C2;&#x6570;&#xFF0C;&#x5728;&#x8F93;&#x5165;&#x65F6;&#x9700;&#x8981;&#x505A;&#x597D;&#x7C7B;&#x578B;&#x68C0;&#x67E5;&#x4E0E;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x3002;</span><p style="background-color:rgb(255,255,255);"></p><p style="background-color:rgb(255,255,255);"><br></p><h1 style="padding:0px;background-color:rgb(255,255,255);"><a></a><span style="font-size:32px;">Addon&#x4E2D;&#x56DE;&#x8C03;NodeJS&#x65B9;&#x6CD5;</span></h1><p style="background-color:rgb(255,255,255);">&#x9996;&#x5148;&#x5728;NodeJS&#x4E2D;&#x5C06;&#x9700;&#x8981;&#x88AB;&#x56DE;&#x8C03;&#x7684;&#x51FD;&#x6570;&#x5730;&#x5740;&#x901A;&#x8FC7;&#x53C2;&#x6570;&#x4F20;&#x5165;&#x3002;</p><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_javascript" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[javascript]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-c" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;background-color:inherit;">MQ.setLogCallback(</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">function</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;(level,&#xA0;message)&#xA0;{&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;console.log(<span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&apos;[&apos;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;+&#xA0;level&#xA0;+&#xA0;</span><span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&apos;]&#xA0;:&#xA0;&apos;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;+&#xA0;message)&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">});&#xA0;&#xA0;</span></li></ol></div><br style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x5728;Addon&#x4E2D;&#xFF0C;&#x5C06;&#x4F20;&#x9012;&#x8FDB;&#x6765;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x4FDD;&#x5B58;</span><p style="background-color:rgb(255,255,255);"></p><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_cpp" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[cpp]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-cpp" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;Persistent&lt;Function&gt;&#xA0;s_logCallback;&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">Handle&lt;Value&gt;&#xA0;setLogCallback(<span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">const</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;Arguments&amp;&#xA0;args)&#xA0;{&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;HandleScope&#xA0;scope;&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;<span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;(args.Length()&#xA0;&lt;&#xA0;1&#xA0;||&#xA0;!args[0]-&gt;IsFunction()&#xA0;)&#xA0;{&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">return</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;ThrowException(Exception::TypeError(String::New(</span><span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&quot;Invalid&#xA0;parameter.&quot;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">)));&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;s_logCallback.Dispose();&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;s_logCallback&#xA0;=&#xA0;Persistent&lt;Function&gt;::New(Local&lt;Function&gt;::Cast(args[0]));&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;<span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">return</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;scope.Close(Undefined());&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">}&#xA0;&#xA0;</span></li></ol></div><br style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x5728;Addon&#x4E2D;&#xFF0C;&#x5F53;&#x9700;&#x8981;&#x56DE;&#x8C03;&#x6B64;&#x51FD;&#x6570;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x5373;&#x53EF;&#x3002;&#x5982;</span><p style="background-color:rgb(255,255,255);"></p><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_cpp" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[cpp]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-cpp" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">(&#xA0;!s_logCallback.IsEmpty()&#xA0;){&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;<span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">const</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;unsigned&#xA0;argc&#xA0;=&#xA0;2;&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;Local&lt;Value&gt;&#xA0;argv[argc]&#xA0;=&#xA0;{&#xA0;&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Local&lt;Value&gt;::New(Number::New(1))&#xA0;,&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Local&lt;Value&gt;::New(String::New(<span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&quot;Test&#xA0;Message&quot;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">))&#xA0;&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;};&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;s_logCallback-&gt;Call(Context::GetCurrent()-&gt;Global(),&#xA0;argc,&#xA0;argv);&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">}&#xA0;&#xA0;</span></li></ol></div><p style="background-color:rgb(255,255,255);"><br></p><h1 style="padding:0px;background-color:rgb(255,255,255);"><a></a><span style="font-size:32px;">&#x591A;&#x7EBF;&#x7A0B;&#x73AF;&#x5883;&#x4E0B;&#x56DE;&#x8C03;&#xA0;</span></h1><p style="background-color:rgb(255,255,255);">NodeJS&#x4E2D;&#x7684;V8&#x5F15;&#x64CE;&#x662F;&#x4EE5;&#x5355;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x7684;&#xFF0C;&#x56DE;&#x8C03;JS&#x65B9;&#x6CD5;&#x4E5F;&#x5FC5;&#x987B;&#x5728;V8&#x7684;&#x4E3B;&#x7EBF;&#x7A0B;&#x4E2D;&#x8FDB;&#x884C;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x53D1;&#x751F;&#x672A;&#x77E5;&#x7684;&#x540E;&#x679C;&#x751A;&#x81F3;crash&#x6389;&#x6574;&#x4E2A;&#x8FDB;&#x7A0B;&#x3002;NodeJS&#x5E95;&#x5C42;&#x7684;libuv&#x63D0;&#x4F9B;&#x4E86;&#x76F8;&#x5E94;&#x7684;&#x901A;&#x77E5;&#x673A;&#x5236;&#x6765;&#x5B9E;&#x73B0;&#x4E3B;&#x7EBF;&#x7A0B;&#x4E2D;&#x7684;&#x8C03;&#x7528;&#x3002;</p><p style="background-color:rgb(255,255,255);">&#x9996;&#x5148;&#x9700;&#x8981;&#x5B9A;&#x4E49; uv_async_t &#x53D8;&#x91CF;</p><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_cpp" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[cpp]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-cpp" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;uv_async_t&#xA0;s_async&#xA0;=&#xA0;{0};&#xA0;&#xA0;</span></span></li></ol></div><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x5728;&#x4E3B;&#x7EBF;&#x7A0B;&#x4E2D;&#x521D;&#x59CB;&#x5316;&#x6B64;&#x53D8;&#x91CF;&#xFF0C;&#x5E76;&#x6CE8;&#x518C;&#x5728;&#x4E3B;&#x7EBF;&#x7A0B;&#x4E2D;&#x6B64;&#x901A;&#x77E5;&#x89E6;&#x53D1;&#x65F6;&#x56DE;&#x8C03;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x6B64;&#x6B65;&#x9AA4;&#x53EF;&#x4EE5;&#x5728;init&#x4E2D;&#x6267;&#x884C;&#x3002;</span><p style="background-color:rgb(255,255,255);"></p><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_cpp" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[cpp]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-cpp" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;background-color:inherit;">uv_async_init(&#xA0;uv_default_loop(),&#xA0;&amp;s_async,&#xA0;onCallback);&#xA0;&#xA0;</span></span></li></ol></div><br style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x800C;onCallback&#x65B9;&#x6CD5;&#x5219;&#x5728;&#x4E3B;&#x7EBF;&#x7A0B;&#x4E2D;&#xFF0C;&#x901A;&#x77E5;&#x53D1;&#x751F;&#x540E;&#x6267;&#x884C;</span><br style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"><div class="dp-highlighter bg_cpp" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[cpp]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-cpp" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;onCallback(uv_async_t*&#xA0;handle,&#xA0;</span><span class="datatypes" style="margin:0px;padding:0px;border:none;color:rgb(46,139,87);background-color:inherit;font-weight:bold;">int</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;status){&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;<span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">(&#xA0;!s_logCallback.IsEmpty()&#xA0;){&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">const</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;unsigned&#xA0;argc&#xA0;=&#xA0;2;&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Local&lt;Value&gt;&#xA0;argv[argc]&#xA0;=&#xA0;{&#xA0;&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Local&lt;Value&gt;::New(Number::New(1))&#xA0;,&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Local&lt;Value&gt;::New(String::New(<span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&quot;Callback&#xA0;is&#xA0;happening&quot;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">))&#xA0;&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;};&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;s_logCallback-&gt;Call(Context::GetCurrent()-&gt;Global(),&#xA0;argc,&#xA0;argv);&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">}&#xA0;&#xA0;</span></li></ol></div><br style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x5728;&#x4EFB;&#x4F55;&#x7EBF;&#x7A0B;&#x4E2D;&#xFF0C;&#x90FD;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;</span><span style="font-weight:700;color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">uv_async_send</span><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x6765;&#x89E6;&#x53D1;&#x6B64;&#x56DE;&#x8C03;&#x7684;&#x6267;&#x884C;&#x3002;</span><p style="background-color:rgb(255,255,255);"></p><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_cpp" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[cpp]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-cpp" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;background-color:inherit;">uv_async_send(&amp;s_async);&#xA0;&#xA0;</span></span></li></ol></div><br style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x5F53;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x56DE;&#x8C03;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EF;&#x4EE5;&#x8C03;&#x7528;</span><span style="font-weight:700;color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">uv_close</span><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x6765;&#x53D6;&#x6D88;&#x6CE8;&#x518C;&#x6B64;&#x56DE;&#x8C03;&#x65B9;&#x6CD5;&#x3002;</span><p style="background-color:rgb(255,255,255);"></p><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_cpp" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[cpp]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-cpp" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;background-color:inherit;">uv_close(&#xA0;&amp;s_async,&#xA0;NULL);&#xA0;&#xA0;</span></span></li></ol></div><br style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"><p style="background-color:rgb(255,255,255);"><span style="background-color:rgb(255,255,0);">&#x8FD9;&#x91CC;&#x7279;&#x522B;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;</span>&#xFF0C;<span style="font-weight:700;">uv_async_send</span>&#x89E6;&#x53D1;&#x56DE;&#x8C03;&#x7684;&#x6B21;&#x6570;&#x5E76;&#x4E0D;&#x662F;&#x4E00;&#x4E00;&#x5BF9;&#x5E94;&#x7684;&#x3002;&#x5B83;&#x53EA;&#x80FD;&#x4FDD;&#x8BC1;&#x6700;&#x5C11;&#x4E00;&#x6B21;&#x7684;&#x89E6;&#x53D1;&#x3002;&#x53EF;&#x80FD;&#x4F1A;&#x51FA;&#x73B0;&#x8FD9;&#x6837;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x8FDE;&#x7EED;&#x8C03;&#x7528;&#x4E86;3&#x6B21;uv_async_send&#x65B9;&#x6CD5;,&#x4F46;&#x56DE;&#x8C03;&#x53EA;&#x88AB;&#x89E6;&#x53D1;&#x4E86;&#x4E00;&#x6B21;&#xFF08;&#x8C03;&#x7528;&#x7B2C;1&#x3001;2&#x3001;3&#x6B21;&#x7684;&#x65F6;&#x5019;&#xFF0C;NodeJS&#x7684;&#x4E3B;&#x5FAA;&#x73AF;&#x53EF;&#x80FD;&#x5FD9;&#x4E8E;&#x5176;&#x5B83;&#x5904;&#x7406;&#x800C;&#x76F4;&#x5230;&#x68C0;&#x6D4B;&#x5230;&#x6B64;&#x901A;&#x77E5;&#x65F6;&#xFF0C;3&#x6B21;&#x8C03;&#x7528;&#x90FD;&#x5DF2;&#x7ECF;&#x53D1;&#x751F;&#x4E86;&#xFF0C;&#x800C;&#x6B64;&#x65F6;&#x53EA;&#x4F1A;&#x8FDB;&#x884C;&#x4E00;&#x6B21;&#x56DE;&#x8C03;&#xFF09;&#x3002;&#x9488;&#x5BF9;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x5E94;&#x8BE5;&#x8BBE;&#x8BA1;&#x76F8;&#x5E94;&#x7684;&#x961F;&#x5217;&#x7ED3;&#x6784;&#x6765;&#x4F20;&#x9012;&#x6570;&#x636E;&#x5230;&#x56DE;&#x8C03;&#x4E2D;&#x4F9D;&#x6B21;&#x5904;&#x7406;&#x3002;</p><p style="background-color:rgb(255,255,255);">&#xA0;</p><p style="background-color:rgb(255,255,255);"></p><h1 style="padding:0px;background-color:rgb(255,255,255);"><a></a>&#x5F02;&#x6B65;&#x8C03;&#x7528;</h1><p style="background-color:rgb(255,255,255);">NodeJS&#x7684;&#x4E3B;&#x7EBF;&#x7A0B;&#x53EA;&#x8D1F;&#x8D23;event loop&#x548C;V8&#x7684;&#x6267;&#x884C;&#xFF0C;&#x5982;&#x679C;addon&#x4E2D;&#x67D0;&#x4E2A;&#x5BFC;&#x51FA;&#x65B9;&#x6CD5;&#x5728;&#x8C03;&#x7528;&#x65F6;&#x4F1A;&#x53D1;&#x751F;&#x963B;&#x585E;&#xFF0C;&#x4F1A;&#x4E25;&#x91CD;&#x5730;&#x5F71;&#x54CD;&#x5230;NodeJS&#x7684;&#x6574;&#x4F53;&#x6027;&#x80FD;&#x3002;&#x56E0;&#x6B64;&#xFF0C;libuv&#x8BBE;&#x8BA1;&#x4E86;&#x5F02;&#x6B65;&#x8C03;&#x7528;&#x7684;&#x65B9;&#x5F0F;--&#x5C06;&#x963B;&#x585E;&#x7C7B;&#x64CD;&#x4F5C;&#x653E;&#x5165;&#x5176;&#x5B83;&#x7EBF;&#x7A0B;&#x4E2D;&#x5904;&#x7406;&#xFF0C;&#x5728;&#x5904;&#x7406;&#x5B8C;&#x6210;&#x540E;&#x56DE;&#x8C03;&#x3002;</p><p style="background-color:rgb(255,255,255);">&#x4F8B;&#x5982;&#xFF0C;JS&#x8C03;&#x7528;&#x5982;&#x4E0B;&#x5BFC;&#x51FA;&#x65B9;&#x6CD5;</p><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_cpp" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[cpp]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-cpp" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span style="margin:0px;padding:0px;border:none;background-color:inherit;">AddOn.lookupIpCountry(&#xA0;ip,&#xA0;function(countryCode){&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;<span class="comment" style="margin:0px;padding:0px;border:none;color:rgb(0,130,0);background-color:inherit;">//&#xA0;get&#xA0;the&#xA0;country&#xA0;code</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;<span class="comment" style="margin:0px;padding:0px;border:none;color:rgb(0,130,0);background-color:inherit;">//&#xA0;...</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">});&#xA0;&#xA0;</span></li></ol></div><br style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x5728;AddOn&#x4E2D;&#xFF0C;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;&#x5728;&#x5F02;&#x6B65;&#x8C03;&#x7528;&#x4E2D;&#x4F20;&#x9012;&#x6570;&#x636E;&#x3002;</span><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_cpp" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[cpp]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-cpp" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">struct</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;LookupIpCountryBaton&#xA0;{&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;uv_work_t&#xA0;work;&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;Persistent&lt;Function&gt;&#xA0;callback;&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;<span class="datatypes" style="margin:0px;padding:0px;border:none;color:rgb(46,139,87);background-color:inherit;font-weight:bold;">char</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;ip[IP_LEN];&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;<span class="datatypes" style="margin:0px;padding:0px;border:none;color:rgb(46,139,87);background-color:inherit;font-weight:bold;">char</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;country_code[COUNTRY_CODE_LEN];&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">};&#xA0;&#xA0;</span></li></ol></div><br style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x5BFC;&#x51FA;&#x65B9;&#x6CD5;&#x9996;&#x5148;&#x4FDD;&#x5B58;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#xFF0C;&#x5E76;&#x9A8C;&#x8BC1;&#x548C;&#x89E3;&#x6790;&#x4F20;&#x5165;&#x53C2;&#x6570;</span><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_cpp" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[cpp]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-cpp" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="comment" style="margin:0px;padding:0px;border:none;color:rgb(0,130,0);background-color:inherit;">//&#xA0;lookup&#xA0;country&#xA0;by&#xA0;ip</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="comment" style="margin:0px;padding:0px;border:none;color:rgb(0,130,0);background-color:inherit;">//&#xA0;1st&#xA0;argument&#xA0;is&#xA0;ip&#xA0;address</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="comment" style="margin:0px;padding:0px;border:none;color:rgb(0,130,0);background-color:inherit;">//&#xA0;2nd&#xA0;argument&#xA0;is&#xA0;the&#xA0;callback&#xA0;function</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">Handle&lt;Value&gt;&#xA0;lookupIpCountry(<span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">const</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;Arguments&amp;&#xA0;args)&#xA0;{&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;HandleScope&#xA0;scope;&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;<span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">if</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;(args.Length()&#xA0;&lt;&#xA0;2&#xA0;||&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;!args[1]-&gt;IsFunction()&#xA0;||&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;(!args[0]-&gt;IsStringObject()&#xA0;&amp;&amp;&#xA0;!args[0]-&gt;IsString())&#xA0;&#xA0;)&#xA0;{&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">return</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;ThrowException(Exception::TypeError(String::New(</span><span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&quot;Invalid&#xA0;parameter.&quot;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">)));&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;String::Utf8Value&#xA0;param1(args[0]-&gt;ToString());&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;<span class="datatypes" style="margin:0px;padding:0px;border:none;color:rgb(46,139,87);background-color:inherit;font-weight:bold;">char</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;*&#xA0;ip&#xA0;=&#xA0;*param1;&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;LookupIpCountryBaton&#xA0;*&#xA0;baton&#xA0;=&#xA0;<span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;LookupIpCountryBaton();&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;baton-&gt;work.data&#xA0;=&#xA0;baton;&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;memset(&#xA0;baton-&gt;country_code,&#xA0;0,&#xA0;COUNTRY_CODE_LEN);&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;memset(&#xA0;baton-&gt;ip,&#xA0;0,&#xA0;IP_LEN);&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;strncpy(&#xA0;baton-&gt;ip,&#xA0;ip,&#xA0;IP_LEN);&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;baton-&gt;callback&#xA0;=&#xA0;Persistent&lt;Function&gt;::New(Local&lt;Function&gt;::Cast(args[1]));&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;uv_queue_work(&#xA0;uv_default_loop(),&#xA0;&amp;baton-&gt;work,&#xA0;lookupIpCountryAsync,&#xA0;lookupIpCountryCompleted);&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;<span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">return</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;Undefined();&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">}&#xA0;&#xA0;</span></li></ol></div><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x8FD9;&#x91CC;&#x6700;&#x5173;&#x952E;&#x7684;&#x662F;</span><span style="font-weight:700;color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">uv_queue_work</span><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">, &#x5B83;&#x5C06;&#x8BF7;&#x6C42;&#x538B;&#x5165;&#x961F;&#x5217;&#x4EA4;&#x7531;&#x5176;&#x5B83;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#xFF0C;&#x540C;&#x65F6;&#x6307;&#x5B9A;&#x5728;&#x7EBF;&#x7A0B;&#x4E2D;&#x6267;&#x884C;&#x7684;&#x51FD;&#x6570;&#xFF08;</span><span style="font-weight:700;color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">lookupIpCountryAsyc</span><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">)&#xFF0C;&#x4EA6;&#x6307;&#x5B9A;&#x4E86;&#x8C03;&#x7528;&#x7ED3;&#x675F;&#x540E;&#x5B8C;&#x6210;&#x7684;&#x51FD;&#x6570;(</span><span style="font-weight:700;color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">lookupIpCountryCompleted</span><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">)</span><p style="background-color:rgb(255,255,255);"><br></p><p style="background-color:rgb(255,255,255);">&#x5728;<span style="font-weight:700;">lookupIpCountryAsyc</span>&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x8FDB;&#x884C;&#x963B;&#x585E;&#x8C03;&#x7528;&#x3002;<span style="background-color:rgb(255,204,102);">&#x8FD9;&#x91CC;&#x8981;&#x6CE8;&#x610F;</span>&#xFF0C;&#x6B64;&#x51FD;&#x6570;&#x4E0D;&#x662F;&#x5728;&#x4E3B;&#x7EBF;&#x7A0B;&#x4E2D;&#x8FD0;&#x884C;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x80FD;&#x8BBF;&#x95EE;&#x6216;&#x8005;&#x8C03;&#x7528;&#x4EFB;&#x4F55;V8&#x6709;&#x5173;&#x7684;&#x51FD;&#x6570;&#x6216;&#x6570;&#x636E;&#x3002;</p><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_cpp" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[cpp]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-cpp" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;lookupIpCountryAsync(uv_work_t&#xA0;*&#xA0;work){&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;LookupIpCountryBaton&#xA0;*&#xA0;baton&#xA0;=&#xA0;(LookupIpCountryBaton*)work-&gt;data;&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;<span class="comment" style="margin:0px;padding:0px;border:none;color:rgb(0,130,0);background-color:inherit;">//&#xA0;block&#xA0;thread&#xA0;for&#xA0;3&#xA0;seconds</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;sleep(3);&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;<span class="comment" style="margin:0px;padding:0px;border:none;color:rgb(0,130,0);background-color:inherit;">//&#xA0;save&#xA0;the&#xA0;result</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;strncpy(&#xA0;baton-&gt;country_code,&#xA0;<span class="string" style="margin:0px;padding:0px;border:none;color:#0000FF;background-color:inherit;">&quot;CN&quot;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&#xA0;COUNTRY_CODE_LEN&#xA0;-&#xA0;1);&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">}&#xA0;&#xA0;</span></li></ol></div><br style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x5F53;&#x6B64;&#x51FD;&#x6570;&#x6267;&#x884C;&#x5B8C;&#x540E;&#xFF0C;</span><span style="font-weight:700;color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">lookupIpCountryCompleted</span><span style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">&#x51FD;&#x6570;&#x4F1A;&#x5728;&#x4E3B;&#x7EBF;&#x7A0B;&#x4E2D;&#x88AB;&#x6267;&#x884C;&#xFF0C;&#x5B8C;&#x6210;&#x56DE;&#x8C03;&#x548C;&#x6E05;&#x7406;&#x5DE5;&#x4F5C;&#x3002;</span><p style="background-color:rgb(255,255,255);"></p><p style="background-color:rgb(255,255,255);"></p><div class="dp-highlighter bg_cpp" style="padding:1px 0px 0px;margin:0px 0px 24px;font-family:Consolas, &apos;Courier New&apos;, Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);width:843.469px;text-align:left;color:rgb(51,51,51);"><div class="bar" style="padding:0px 0px 0px 45px;margin:0px;"><div class="tools" style="padding:3px 8px 10px 10px;margin:0px;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left:3px solid rgb(108,226,108);border-right:1px solid rgb(231,229,220);"><span>[cpp]</span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="ViewSource" title="view plain" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_plain.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">view plain</a><span>&#xA0;<a href="https://blog.csdn.net/wangjia184/article/details/18940165#" rel="nofollow" class="CopyToClipboard" title="copy" style="background-image:url(&quot;https://csdnimg.cn/release/phoenix/images/ico_copy.gif&quot;);background-position:left top;background-repeat:no-repeat;background-color:inherit;border:none;padding:1px;margin:0px 10px 0px 0px;font-size:9px;width:16px;height:16px;text-indent:-2000px;" data-token="027f24862bbfb0684e64c35c4267f3e0">copy</a></span><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><div style="padding:0px;margin:0px;width:16px;height:16px;"></div><span></span></div></div><ol start="1" class="dp-cpp" style="border-top:none;border-right:1px solid rgb(231,229,220);border-bottom:none;border-left:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;"><span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;lookupIpCountryCompleted(uv_work_t&#xA0;*&#xA0;work,&#xA0;</span><span class="datatypes" style="margin:0px;padding:0px;border:none;color:rgb(46,139,87);background-color:inherit;font-weight:bold;">int</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">){&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;LookupIpCountryBaton&#xA0;*&#xA0;baton&#xA0;=&#xA0;(LookupIpCountryBaton*)work-&gt;data;&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;<span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">const</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;unsigned&#xA0;argc&#xA0;=&#xA0;1;&#xA0;&#xA0;</span></span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;Local&lt;Value&gt;&#xA0;argv[argc]&#xA0;=&#xA0;{&#xA0;&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Local&lt;Value&gt;::New(String::New(baton-&gt;country_code))&#xA0;,&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;};&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;baton-&gt;callback-&gt;Call(Context::GetCurrent()-&gt;Global(),&#xA0;argc,&#xA0;argv);&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;</span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;baton-&gt;callback.Dispose();&#xA0;&#xA0;</span></li><li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);color:inherit;line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">&#xA0;&#xA0;&#xA0;&#xA0;<span class="keyword" style="margin:0px;padding:0px;border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">delete</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&#xA0;baton;&#xA0;&#xA0;</span></span></li><li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);background-color:rgb(248,248,248);line-height:18px;padding:0px 3px 0px 10px;margin-right:0px;margin-bottom:0px;list-style-position:outside;"><span style="margin:0px;padding:0px;border:none;color:#000000;background-color:inherit;">} &#xA0;</span></li></ol></div>                                    