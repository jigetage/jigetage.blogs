
                                            <p>&#x539F;&#x6587;&#x94FE;&#x63A5;&#xA0;<a href="http://www.360doc.com/content/18/0718/15/57911523_771428799.shtml" rel="nofollow" data-token="32cbb36d1a0e65223751aa208248916a">&#x70B9;&#x51FB;&#x67E5;&#x770B;&#x539F;&#x6587;</a></p>

<p><strong>&#x76EE;&#x6807;&#x8981;&#x6C42;&#xFF1A;</strong><br>
&#xA0; &#xA0; &#xA0; &#xA0;1&#x3001; &#x754C;&#x9762;border&#x53BB;&#x6389;&#x539F;&#x672C;windows&#x81EA;&#x5E26;&#x7684;&#x5BF9;&#x8BDD;&#x6846;&#x683C;&#x5F0F;&#xFF0C;&#x91C7;&#x53D6;&#x6241;&#x5E73;&#x5316;&#x8BBE;&#x8BA1;&#xFF1B;<br>
&#xA0; &#xA0; &#xA0; &#xA0;2&#x3001; &#x7B80;&#x5316;&#x5B89;&#x88C5;&#x6D41;&#x7A0B;&#xFF0C;&#x4E0D;&#x8981;&#x5F39;&#x51FA;&#x90A3;&#x4E48;&#x591A;&#x5B89;&#x88C5;&#x5411;&#x5BFC;&#x9875;&#xFF0C;&#x4E0D;&#x8981;&#x8BA9;&#x7528;&#x6237;&#x4E00;&#x76F4;&#x70B9;&#x201C;&#x4E0B;&#x4E00;&#x6B65;&#x201D;&#xFF0C;&#x7B80;&#x6D01;&#x4EBA;&#x6027;&#x5316;&#xFF1B;<br>
&#xA0; &#xA0; &#xA0; &#xA0;3&#x3001; &#x5B89;&#x88C5;&#x754C;&#x9762;&#x53EF;&#x52A0;&#x8F7D;&#x6F02;&#x4EAE;&#x7684;&#x80CC;&#x666F;&#x56FE;&#x7247;&#xFF1B;<br>
&#xA0; &#xA0; &#xA0; &#xA0;4&#x3001; &#x4F18;&#x5316;&#x5B89;&#x88C5;&#x5305;&#x5B89;&#x88C5;&#x65F6;&#x95F4;&#x3002;<br>
&#xA0; &#xA0; &#xA0; &#xA0;<strong>&#x539F;&#x578B;&#x8BBE;&#x8BA1;&#xFF1A;</strong></p>

<p>&#xA0;</p>

<p>&#x754C;&#x9762;1</p>

<p><img alt class="has" src="https://img-blog.csdn.net/20180718161931843?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ppZ2V0YWdl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p>

<p>&#x754C;&#x9762;2</p>

<p><img alt class="has" src="https://img-blog.csdn.net/20180718161951915?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ppZ2V0YWdl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p>

<p>&#x754C;&#x9762;3</p>

<p>&#xA0; &#xA0; &#xA0; &#xA0;<strong>&#x5F00;&#x53D1;&#x5DE5;&#x5177;&#xFF1A;</strong><br>
&#xA0; &#xA0; &#xA0; &#xA0;&#x56E0;&#x4E3A;&#x4E4B;&#x524D;&#x91C7;&#x7528;Inno setup&#x8BBE;&#x8BA1;&#xFF0C;&#x800C;&#x4E14;&#x5B83;&#x62E5;&#x6709;Pascal&#x811A;&#x672C;&#x5F15;&#x64CE;&#xFF0C;&#x529F;&#x80FD;&#x7B97;&#x5F3A;&#x5927;&#xFF0C;&#x6545;&#x91C7;&#x7528;Inno setup&#x3002;<br>
&#xA0; &#xA0; &#xA0; &#xA0;<strong>&#x4E3B;&#x8981;&#x6D41;&#x7A0B;&#xFF1A;</strong></p>

<p>&#xA0; &#xA0; &#xA0; &#xA0;<img alt class="has" src="https://img-blog.csdn.net/20180718162007578?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ppZ2V0YWdl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p>

<p>&#x6D41;&#x7A0B;&#x56FE;</p>

<p><img alt class="has" src="https://img-blog.csdn.net/20180718162025663?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ppZ2V0YWdl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p>

<p>&#xA0; &#xA0; &#xA0; &#xA0;&#x7531;&#x56FE;&#x4E2D;&#x53EF;&#x4EE5;&#x6E05;&#x6670;&#x5730;&#x770B;&#x51FA;&#xFF0C;&#x6240;&#x6709;&#x5411;&#x5BFC;&#x9875;&#x4E4B;&#x95F4;&#x90FD;&#x662F;&#x901A;&#x8FC7;&#x201C;&#x4E0B;&#x4E00;&#x6B65;&#x201D;&#x6216;&#x8005;&#x201C;&#x4E0A;&#x4E00;&#x6B65;&#x201D;&#x8FDB;&#x884C;&#x9A71;&#x52A8;&#x66F4;&#x6362;&#x7684;&#x3002;<br>
&#xA0; &#xA0; &#xA0; &#xA0;<strong>&#x6982;&#x8981;&#x5206;&#x6790;&#xFF1A;</strong><br>
&#xA0; &#xA0; &#xA0; &#xA0;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x8C03;&#x7528;&#x4E24;&#x4E2A;&#x7F8E;&#x5316;&#x63D2;&#x4EF6;&#x52A8;&#x6001;&#x5E93;&#xFF1A;botva2.dll&#x548C;InnoCallback.dll&#xFF0C;&#x7528;&#x4E8E;&#x754C;&#x9762;&#x7684;&#x7F8E;&#x5316;&#x548C;&#x529F;&#x80FD;&#x5B8C;&#x5584;&#x3002;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x5168;&#x90E8;&#x628A;&#x4EE3;&#x7801;&#x8D34;&#x51FA;&#x6765;&#x4E86;&#xFF0C;&#x53EA;&#x9488;&#x5BF9;&#x5176;&#x4E2D;&#x7684;&#x8981;&#x70B9;&#x8FDB;&#x884C;&#x5206;&#x6790;&#x6982;&#x62EC;&#x3002;<br>
&#xA0; &#xA0; &#xA0; &#xA0;&#x5728;&#x5F00;&#x59CB;&#x4E4B;&#x524D;&#xFF0C;&#x5148;&#x4E86;&#x89E3;&#x4E00;&#x4E0B;inno setup&#x57FA;&#x672C;&#x7684;&#x8FC7;&#x7A0B;&#x548C;&#x51FD;&#x6570;&#x3002;</p>

<pre class="has"><code>//&#x8BE5;&#x8FC7;&#x7A0B;&#x5728;&#x5F00;&#x59CB;&#x7684;&#x65F6;&#x5019;&#x6539;&#x53D8;&#x5411;&#x5BFC;&#x6216;&#x8005;&#x5411;&#x5BFC;&#x9875;&#xFF0C;&#x4E0D;&#x8981;&#x6307;&#x671B;&#x4F7F;&#x7528;InitializeSetup&#x51FD;&#x6570;&#x5B9E;&#x73B0;&#x6539;&#x53D8;&#x5411;&#x5BFC;&#x9875;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x56E0;&#x4E3A;InitializeSetup&#x51FD;&#x6570;&#x89E6;&#x53D1;&#x65F6;&#x5411;&#x5BFC;&#x7A97;&#x53E3;&#x5E76;&#x4E0D;&#x5B58;&#x5728;&#x3002;
procedure InitializeWizard();

//&#x8BE5;&#x51FD;&#x6570;&#x5728;&#x5B89;&#x88C5;&#x7A0B;&#x5E8F;&#x521D;&#x59CB;&#x5316;&#x65F6;&#x8C03;&#x7528;&#xFF0C;&#x8FD4;&#x56DE;False &#x5C06;&#x4E2D;&#x65AD;&#x5B89;&#x88C5;&#xFF0C;True&#x5219;&#x7EE7;&#x7EED;&#x5B89;&#x88C5;.
function InitializeSetup(): Boolean;

//&#x8BE5;&#x8FC7;&#x7A0B;&#x63D0;&#x4F9B;&#x7528;&#x6237;&#x5B8C;&#x6210;&#x9884;&#x5B89;&#x88C5;&#x548C;&#x5B89;&#x88C5;&#x4E4B;&#x540E;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x66F4;&#x591A;&#x7684;&#x662F;&#x63D0;&#x4F9B;&#x4E86;&#x5B89;&#x88C5;&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x72B6;&#x6001;&#x3002;&#x53C2;&#x6570;CurStep=ssInstall&#x662F;&#x5728;&#x7A0B;&#x5E8F;&#x5B9E;&#x9645;&#x5B89;&#x88C5;&#x524D;&#xFF0C;CurStep=ssPostInstall&#x662F;&#x5B9E;&#x9645;&#x5B89;&#x88C5;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x800C;CurStep=ssDone&#x662F;&#x5728;&#x4E00;&#x6B21;&#x6210;&#x529F;&#x7684;&#x5B89;&#x88C5;&#x5B8C;&#x6210;&#x540E;&#x3001;&#x5B89;&#x88C5;&#x7A0B;&#x5E8F;&#x7EC8;&#x6B62;&#x524D;&#xFF08;&#x5373;&#x70B9;&#x51FB;finish&#x6309;&#x94AE;&#x540E;&#x6267;&#x884C;&#xFF09;&#x3002; 
procedure CurStepChanged(CurStep: TSetupStep);

//&#x5F53;&#x7528;&#x6237;&#x5355;&#x51FB;&#x4E0B;&#x4E00;&#x6B65;&#x6309;&#x94AE;&#x65F6;&#x8C03;&#x7528;&#x3002;&#x5982;&#x679C;&#x8FD4;&#x56DE;True&#xFF0C;&#x5411;&#x5BFC;&#x5C06;&#x79FB;&#x5230;&#x4E0B;&#x4E00;&#x9875;&#xFF1B;&#x5982;&#x679C;&#x8FD4;&#x56DE;False&#xFF0C;&#x5B83;&#x4ECD;&#x4FDD;&#x7559;&#x5728;&#x5F53;&#x524D;&#x9875;&#x3002;
function NextButtonClick(CurPageID: Integer): Boolean;

//&#x5411;&#x5BFC;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x51FD;&#x6570;&#x786E;&#x5B9A;&#x662F;&#x5426;&#x5728;&#x6240;&#x6709;&#x9875;&#x6216;&#x4E0D;&#x5728;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x9875; (&#x7528;PageID &#x6307;&#x5B9A;) &#x663E;&#x793A;&#x3002;&#x5982;&#x679C;&#x8FD4;&#x56DE;True&#xFF0C;&#x5C06;&#x8DF3;&#x8FC7;&#x8BE5;&#x9875;&#xFF1B;&#x5982;&#x679C;&#x4F60;&#x8FD4;&#x56DE;False&#xFF0C;&#x8BE5;&#x9875;&#x88AB;&#x663E;&#x793A;&#x3002;&#x6CE8;&#x610F;: &#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x51FD;&#x6570;&#x4E0D;&#x88AB;wpWelcome&#x3001;wpPreparing &#x548C;wpInstalling &#x9875;&#x8C03;&#x7528;&#xFF0C;&#x8FD8;&#x6709;&#x5B89;&#x88C5;&#x7A0B;&#x5E8F;&#x5DF2;&#x7ECF;&#x786E;&#x5B9A;&#x8981;&#x8DF3;&#x8FC7;&#x7684;&#x9875;&#x4E5F;&#x4E0D;&#x4F1A;&#x8C03;&#x7528; (&#x4F8B;&#x5982;&#xFF0C;&#x6CA1;&#x6709;&#x5305;&#x542B;&#x7EC4;&#x4EF6;&#x5B89;&#x88C5;&#x7A0B;&#x5E8F;&#x7684;wpSelectComponents)&#x3002;
function ShouldSkipPage(PageID: Integer): Boolean;

//&#x5728;&#x65B0;&#x5411;&#x5BFC;&#x9875; (&#x7531;CurPageID &#x6307;&#x5B9A;) &#x663E;&#x793A;&#x540E;&#x8C03;&#x7528;&#x3002;
procedure CurPageChanged(CurPageID: Integer);</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0; 1&#x3001; &#x754C;&#x9762;border&#x53BB;&#x6389;&#x539F;&#x672C;windows&#x81EA;&#x5E26;&#x7684;&#x5BF9;&#x8BDD;&#x6846;&#x683C;&#x5F0F;&#xFF0C;&#x91C7;&#x53D6;&#x6241;&#x5E73;&#x5316;&#x8BBE;&#x8BA1;</p>

<pre class="has"><code>//&#x8BBE;&#x7F6E;&#x6B22;&#x8FCE;&#x5411;&#x5BFC;&#x9875;&#x7684;&#x5C3A;&#x5BF8;&#x5927;&#x5C0F;&#xFF1A; 
WizardForm.Center WizardForm.BorderStyle:=bsNone; //&#x53BB;&#x6389;&#x5BF9;&#x8BDD;&#x6846;border WizardForm.ClientWidth:=601; 
WizardForm.ClientHeight:=341; 
WizardForm.InnerNotebook.Hide; 
WizardForm.OuterNotebook.Hide; 
wizardform.Color:=TransparentColor; 
WizardForm.Bevel.Hide; 
WizardForm.NextButton.Width:=0; 
WizardForm.BackButton.Width:=0; 
WizardForm.CancelButton.Width:=0; 
WizardForm.OnMouseDown:=@WizardFormMouseDown; //&#x53EF;&#x62C9;&#x52A8;</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0;2&#x3001; &#x7B80;&#x5316;&#x5B89;&#x88C5;&#x5305;&#x5B89;&#x88C5;&#x6D41;&#x7A0B;&#xFF0C;&#x4E0D;&#x8981;&#x7528;&#x6237;&#x4E00;&#x76F4;&#x70B9;&#x201C;&#x4E0B;&#x4E00;&#x6B65;&#x201D;&#xFF0C;&#x7B80;&#x6D01;&#x4EBA;&#x6027;&#x5316;<br>
&#xA0; &#xA0; &#xA0; &#xA0;&#x8FD9;&#x91CC;&#x53EA;&#x6709;&#x4E24;&#x4E2A;&#x5411;&#x5BFC;&#x9875;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;&#x9009;&#x62E9;&#x5B89;&#x88C5;&#x76EE;&#x5F55;&#x548C;&#x8BB8;&#x53EF;&#x534F;&#x8BAE;&#x7684;&#x754C;&#x9762;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;&#x6B63;&#x5728;&#x5B89;&#x88C5;&#x7684;&#x754C;&#x9762;&#x3002;&#x7528;&#x6237;&#x53EA;&#x9700;&#x70B9;&#x51FB;&#x201C;&#x5F00;&#x59CB;&#x5B89;&#x88C5;&#x201D;&#x5373;&#x53EF;&#x5B89;&#x88C5;&#xFF0C;&#x5E76;&#x6709;&#x8FDB;&#x5EA6;&#x6761;&#x548C;&#x767E;&#x5206;&#x6BD4;&#x663E;&#x793A;&#xFF0C;&#x4E0D;&#x7528;&#x7ECF;&#x5E38;&#x6027;&#x5730;&#x70B9;&#x51FB;&#x201C;&#x4E0B;&#x4E00;&#x6B65;&#x201D;&#x3002;<br>
&#xA0; &#xA0; &#xA0; &#xA0;3&#x3001; &#x5B89;&#x88C5;&#x754C;&#x9762;&#x53EF;&#x52A0;&#x8F7D;&#x6F02;&#x4EAE;&#x7684;&#x56FE;&#x7247;&#x548C;&#x52A8;&#x753B;&#x6548;&#x679C;</p>

<pre class="has"><code>// &#x521B;&#x5EFA;&#x63CF;&#x8FF0;&#x4F4D;&#x56FE;
Bmp:= TBitmapImage.Create(WizardForm);
Bmp.Top:=ScaleX(0);
Bmp.Left:=ScaleX(0);
Bmp.Width:=WizardForm.ClientWidth;
Bmp.Height:=ScaleY(371);
Bmp.BackColor:= WizardForm.Color;
Bmp.Parent:=WizardForm;
Bmp.Bitmap.LoadFromFile(ExpandConstant(&apos;{tmp}\bg.bmp&apos;));
Bmp.OnMouseDown := @WizardFormMouseDown; //&#x53EF;&#x62C9;&#x52A8;

//&#x52A8;&#x753B;&#x6548;&#x679C;
AnimateWindow(StrToInt(ExpandConstant(&apos;{wizardhwnd}&apos;)), 400, AW_Center or AW_Activate);
SetWindowLong(StrToInt(ExpandConstant(&apos;{wizardhwnd}&apos;)),GWL_Exstyle, WS_Ex_Layered);
SetLayeredWindowAttributes(StrToInt(ExpandConstant(&apos;{wizardhwnd}&apos;)), 0, 240, LWA_Alpha);</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0;4&#x3001; &#x4F18;&#x5316;&#x5B89;&#x88C5;&#x5305;&#x5B89;&#x88C5;&#x65F6;&#x95F4;&#x3002;<br>
&#xA0; &#xA0; &#xA0; &#xA0;&#x628A;&#x4E0D;&#x7528;&#x7684;&#x5B89;&#x88C5;&#x6587;&#x4EF6;&#x91CD;&#x65B0;&#x68B3;&#x7406;&#x4E86;&#x4E00;&#x904D;&#xFF0C;&#x51CF;&#x5C11;&#x6253;&#x5305;&#x65F6;&#x7684;&#x4F53;&#x79EF;&#xFF0C;&#x4E0D;&#x7528;&#x591A;&#x6B21;&#x8C03;&#x7528;&#x8BFB;&#x5199;&#x6CE8;&#x518C;&#x8868;&#x3002;</p>

<p>&#xA0; &#xA0; &#xA0; &#xA0;<strong>&#x96BE;&#x70B9;&#x5206;&#x6790;&#xFF1A;</strong><br>
&#xA0; &#xA0; &#xA0; &#xA0;1&#x3001; &#x5982;&#x4F55;&#x8DF3;&#x8FC7;&#x5411;&#x5BFC;&#x9875;&#xFF1F;</p>

<pre class="has"><code>//&#x4E3B;&#x8981;&#x662F;&#x7A0B;&#x5E8F;&#x8C03;&#x7528;&#x201C;&#x4E0B;&#x4E00;&#x6B65;&#x201D;&#xFF0C;&#x7136;&#x540E;&#x5728;ShouldSkipPage&#x51FD;&#x6570;&#x4E2D;&#x8FDB;&#x884C;&#x8DF3;&#x8FC7;&#x3002;
function ShouldSkipPage(PageID: Integer): Boolean;
begin
if PageID=wpWelcome then 
result := true;
if PageID=wpSelectDir then 
result := true;
end;</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0;2&#x3001; &#x201C;&#x4E0B;&#x4E00;&#x6B65;&#x201D;&#x5982;&#x4F55;&#x8C03;&#x7528;&#xFF1F;</p>

<pre class="has"><code>WizardForm.NextButton.OnClick(WizardForm);</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0;3&#x3001; &#x5982;&#x4F55;&#x7528;&#x9F20;&#x6807;&#x62C9;&#x52A8;&#x5BF9;&#x8BDD;&#x6846;&#xFF1F;</p>

<pre class="has"><code>&#x91CD;&#x8F7D;WizardFormMouseDown&#x8FC7;&#x7A0B;&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;SendMessage(WizardForm.Handle, WM_SYSCOMMAND, $F012, 0);</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0;4&#x3001; &#x5982;&#x4F55;&#x81EA;&#x5B9A;&#x4E49;&#x6D4F;&#x89C8;&#x6587;&#x4EF6;&#x5939;&#x6309;&#x94AE;&#xFF1F;</p>

<pre class="has"><code>//&#x8BB0;&#x4F4F;&#xFF0C;&#x83B7;&#x5F97;&#x7684;&#x8DEF;&#x5F84;&#x8981;&#x8D4B;&#x7ED9;WizardForm.DirEdit.Text&#xFF0C;&#x8FD9;&#x662F;&#x6D4F;&#x89C8;&#x6587;&#x4EF6;&#x5939;&#x5411;&#x5BFC;&#x9875;wpSelectDir&#x7684;&#x8DEF;&#x5F84;&#x7F16;&#x8F91;&#x6846;&#x3002;
procedure DirOnClick(hBtn:HWND);
var
res: Boolean;
UserSelectDir,str: string;
begin 
UserSelectDir := Edit.Text; 
res := BrowseForFolder(&apos;&#x6D4F;&#x89C8;&#x6587;&#x4EF6;&#x5939;&apos;, UserSelectDir, True); 

if res then 
begin 
str:=Copy(UserSelectDir,Length(UserSelectDir),1);//&#x53D6;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;
 if &apos;\&apos;=str then
 Edit.Text := UserSelectDir 
else 
Edit.Text := UserSelectDir; 
end; 

//&#x6D4F;&#x89C8;&#x6587;&#x4EF6;&#x5939;&#x5411;&#x5BFC;&#x9875;&#x7684;&#x6587;&#x4EF6;&#x5939;&#x8DEF;&#x5F84; 
WizardForm.DirEdit.Text := Edit.Text;
end;</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0;5&#x3001; &#x5982;&#x4F55;&#x70B9;&#x51FB;&#x6309;&#x94AE;&#x663E;&#x793A;&#x201C;&#x8BB8;&#x53EF;&#x534F;&#x8BAE;&#x201D;&#xFF1F;</p>

<pre class="has"><code>ShellExec(&apos;&apos;, ExpandConstant(&apos;{tmp}\license.txt&apos;),&apos;&apos;, &apos;&apos;, SW_SHOW, ewNoWait, ErrorCode)&#x3002;</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0;6&#x3001; &#x5982;&#x4F55;&#x5B89;&#x88C5;&#x7A0B;&#x5E8F;&#x5B8C;&#x6210;&#x540E;&#x81EA;&#x52A8;&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;&#xFF1F;</p>

<pre class="has"><code>Exec(ExpandConstant(&apos;{app}\MySoftware.exe&apos;), &apos;&apos;, &apos;&apos;, SW_SHOW, ewNoWait, RCode);</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0;7&#x3001; &#x5982;&#x4F55;&#x5220;&#x9664;&#x6587;&#x4EF6;&#x5939;&#xFF1F;</p>

<pre class="has"><code>DelTree(ExpandConstant(&apos;{app}\&#x6587;&#x4EF6;&#x5939;&#x540D;&#x79F0;&apos;), True, True, False);</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0;8&#x3001; &#x5982;&#x4F55;&#x5173;&#x95ED;&#x5411;&#x5BFC;&#x9875;&#xFF1F;</p>

<pre class="has"><code>WizardForm.Close;</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0;9&#x3001; &#x5982;&#x4F55;&#x81EA;&#x5B9A;&#x4E49;&#x5B8C;&#x6210;&#x5411;&#x5BFC;&#x9875;&#x7684;&#x5B8C;&#x6210;&#x6309;&#x94AE;&#xFF1F;</p>

<pre class="has"><code>&#x901A;&#x8FC7;&#x7A0B;&#x5E8F;&#x81EA;&#x884C;&#x8C03;&#x7528;WizardForm.NextButton.OnClick(WizardForm);&#x8FBE;&#x5230;&#x201C;&#x4E0B;&#x4E00;&#x6B65;&#x201D;&#x7684;&#x529F;&#x80FD;&#xFF1B;
&#x7136;&#x540E;&#x901A;&#x8FC7;&#x51FD;&#x6570;ShouldSkipPage&#x4E00;&#x76F4;&#x8C03;&#x5230;&#x6700;&#x540E;&#x5B8C;&#x6210;&#x9875;wpFinished&#xFF1B;
&#x6700;&#x540E;&#x8C03;&#x7528;WizardForm.NextButton.OnClick(WizardForm);&#x5B8C;&#x6210;&#x3002;</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0;10&#x3001; &#x5982;&#x4F55;&#x5728;&#x5B89;&#x88C5;&#x9875;&#x9762;&#x6362;&#x80CC;&#x666F;&#x56FE;&#x7247;&#xFF1F;</p>

<pre class="has"><code>procedure CurPageChanged(CurPageID: Integer);
begin 
if CurPageID = wpInstalling then 
begin 
Bmp:= TBitmapImage.Create(WizardForm); 
Bmp.Top:=ScaleX(0); 
Bmp.Left:=ScaleX(0); 
Bmp.Width:=WizardForm.ClientWidth;
Bmp.Height:=ScaleY(371); 
Bmp.BackColor:= WizardForm.Color;
Bmp.Parent:= WizardForm; 
Bmp.Bitmap.LoadFromFile(ExpandConstant(&apos;{tmp}\bg2.bmp&apos;)); 
Bmp.OnMouseDown := @WizardFormMouseDown; 
WizardForm.OnMouseDown:=@WizardFormMouseDown; 
end;
end;</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0; 11&#x3001; &#x5982;&#x4F55;&#x8BFB;&#x5199;&#x6CE8;&#x518C;&#x8868;&#xFF1F;</p>

<pre class="has"><code>//&#x8BFB;&#x53D6;&#x4FE1;&#x606F;
RegQueryStringValue(HKLM, &apos;Software\***\***&apos;,&apos;Version&apos;,svValue)
//&#x5199;&#x5165;&#x4FE1;&#x606F;
RegWriteStringValue(HKLM, &apos;Software\***\***&apos;,&apos;Version&apos;, &apos;4.0&apos;);</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0; 12&#x3001; &#x5B89;&#x88C5;&#x524D;&#x5982;&#x4F55;&#x5224;&#x65AD;&#x662F;&#x5426;&#x6709;&#x8FDB;&#x7A0B;&#x6B63;&#x5728;&#x8FDB;&#x884C;&#xFF1F;</p>

<pre class="has"><code>//&#x5B89;&#x88C5;&#x524D;&#x5224;&#x65AD;&#x662F;&#x5426;&#x6709;&#x8FDB;&#x7A0B;&#x6B63;&#x5728;&#x8FD0;&#x884C;
function IsModuleLoaded(modulename: String ): Boolean;
external &apos;IsModuleLoaded@files:psvince.dll stdcall setuponly&apos;;
IsModuleLoaded(&apos;Mysoftware.exe&apos;);</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0; 13&#x3001; &#x5982;&#x4F55;&#x4F7F;&#x7528;botva2.dll&#x63D2;&#x4EF6;&#x521B;&#x5EFA;&#x81EA;&#x5B9A;&#x4E49;&#x6309;&#x94AE;&#xFF1F;</p>

<pre class="has"><code>//&#x8C03;&#x7528;&#x52A8;&#x6001;&#x5E93;&#x51FD;&#x6570;
function BtnCreate(hParent :HWND; Left, Top, Width, Height :integer; FileName :PAnsiChar; ShadowWidth :integer; IsCheckBtn :boolean) :HWND;
external &apos;BtnCreate@files:botva2.dll stdcall&apos;;

FinishBtnH := BtnCreate(WizardForm.Handle,ProgressBar.Left+ProgressBar.Width-83, ProgressBar.Top+ProgressBar.Height+ScaleX(10), ScaleX(83), ScaleY(28),ExpandConstant(&apos;{tmp}\Finish.png&apos;),1,False);
BtnSetEvent(FinishBtnH,BtnClickEventID,WrapBtnCallback(@FinishButtonClick,1));
BtnSetVisibility(FinishBtnH,False);</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0; 14&#x3001; &#x767E;&#x5206;&#x6BD4;&#x5982;&#x4F55;&#x786E;&#x5B9A;&#xFF1F;</p>

<pre class="has"><code>//&#x767E;&#x5206;&#x6BD4;
function PBProc(h:hWnd;Msg,wParam,lParam:Longint):Longint;
var 
pr,i1,i2 : Extended; 
w : integer; 
begin 
Result:=CallWindowProc(PBOldProc,h,Msg,wParam,lParam);
 if (Msg=$402) and (WizardForm.ProgressGauge.Position&gt;WizardForm.ProgressGauge.Min) then 
begin 
i1:=WizardForm.ProgressGauge.Position-WizardForm.ProgressGauge.Min; 
i2:=WizardForm.ProgressGauge.Max-WizardForm.ProgressGauge.Min; 
pr:=i1*100/i2; 
PrLabel.Caption:=IntToStr(Round(pr))+&apos;%&apos;; 
w:=Round(110*pr/100); //&#x6539;&#x53D8;&#x6570;&#x503C;&#xFF0C;&#x8FBE;&#x5230;&#x767E;&#x5206;&#x6BD4;&#x548C;&#x8FDB;&#x5EA6;&#x6761;&#x7684;&#x540C;&#x6B65; 
ProgressBar.Position := w; 
end;
end;</code></pre>

<p>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0;<strong>&#x9519;&#x8BEF;&#x89E3;&#x51B3;&#xFF1A;</strong><br>
&#xA0; &#xA0; &#xA0; &#xA0; &#x5BF9;&#x4E8E;&#x67D0;&#x4E9B;&#x7535;&#x8111;&#x73AF;&#x5883;&#xFF0C;&#x5B89;&#x88C5;&#x65F6;&#x53EA;&#x8981;&#x70B9;&#x51FB;&#x201C;&#x9000;&#x51FA;&#x201D;&#x6309;&#x94AE;&#x6216;&#x8005;&#x5B89;&#x88C5;&#x5B8C;&#x540E;&#x603B;&#x4F1A;&#x9047;&#x5230;&#x8FD9;&#x4E2A;&#x9519;&#x8BEF;&#xFF0C;&#x5F39;&#x51FA;&#x4EE5;&#x4E0B;&#x63D0;&#x793A;&#x56FE;&#x7247;&#xFF1A;</p>

<p><img alt class="has" src="https://img-blog.csdn.net/2018071816204737?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ppZ2V0YWdl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p>

<p>&#x9519;&#x8BEF;&#x95EE;&#x9898;</p>

<p>&#xA0; &#xA0; &#xA0; &#xA0; &#x89E3;&#x51B3;&#x529E;&#x6CD5;:</p>

<pre class="has"><code>&#x56E0;&#x4E3A;&#x8C03;&#x7528;WizardForm.Close&#x6216;&#x8005;WizardForm.NextButton.OnClick(WizardForm)&#x9000;&#x51FA;&#x65F6;&#x6CA1;&#x6709;&#x8FDB;&#x884C;WizardForm&#x7684;&#x8D44;&#x6E90;&#x91CA;&#x653E;&#xFF0C;&#x6240;&#x4EE5;&#x5BFC;&#x81F4;&#x4E86;&#x8BE5;&#x9519;&#x8BEF;&#x3002;&#x53EA;&#x8981;&#x5728;&#x9000;&#x51FA;&#x6216;&#x8005;&#x5B8C;&#x6210;&#x524D;&#x52A0;&#x4E0A;WizardForm.Release&#x5373;&#x53EF;&#x89E3;&#x51B3;&#x3002;</code></pre>                                    